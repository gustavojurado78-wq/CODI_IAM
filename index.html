<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard C√≥digo IAM - Atenci√≥n Primaria</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 30px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .clock {
            text-align: right;
        }

        .clock .time {
            font-size: 28px;
            font-weight: 700;
            font-variant-numeric: tabular-nums;
        }

        .clock .date {
            font-size: 14px;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .section {
            border-radius: 12px;
            padding: 24px;
            border: 2px solid;
        }

        .section h2 {
            font-size: 20px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-patient { background: #f8fafc; border-color: #e2e8f0; }
        .section-timeline { background: #f0fdf4; border-color: #bbf7d0; }
        .section-ecg { background: #fef3c7; border-color: #fde047; }
        .section-clinical { background: #ede9fe; border-color: #c4b5fd; }
        .section-contra { background: #fee2e2; border-color: #fca5a5; }
        .section-strategy { background: #dbeafe; border-color: #93c5fd; }
        .section-meds { background: #f0fdfa; border-color: #99f6e4; }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full {
            grid-column: 1 / -1;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-size: 13px;
            font-weight: 600;
            color: #475569;
        }

        input[type="text"],
        input[type="number"],
        input[type="time"],
        select,
        textarea {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            font-size: 15px;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3b82f6;
        }

        textarea {
            min-height: 60px;
            resize: vertical;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid;
            margin-bottom: 10px;
            transition: transform 0.1s;
        }

        .checkbox-item:active {
            transform: scale(0.98);
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-item span {
            font-weight: 500;
            font-size: 14px;
        }

        .alert-box {
            background: #fee2e2;
            border: 3px solid #dc2626;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            animation: pulse 2s infinite;
            margin-top: 20px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .alert-box .icon {
            font-size: 32px;
            color: #dc2626;
        }

        .alert-box .text {
            font-weight: 700;
            font-size: 18px;
            color: #dc2626;
        }

        .time-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .time-row input {
            flex: 1;
            font-weight: 600;
        }

        .btn {
            padding: 10px 16px;
            background: #22c55e;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            transition: background 0.2s;
        }

        .btn:hover {
            background: #16a34a;
        }

        .btn-primary {
            background: #3b82f6;
            padding: 16px 32px;
            font-size: 16px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        .btn-success {
            background: #10b981;
            padding: 16px 32px;
            font-size: 16px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-warning {
            width: 100%;
            background: #eab308;
            padding: 12px;
            font-size: 15px;
            font-weight: 700;
            border-radius: 8px;
        }

        .btn-warning:hover {
            background: #ca8a04;
        }
        
        .footer .btn-warning {
            width: auto;
            padding: 16px 32px;
            font-size: 16px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .footer .btn-warning:hover {
            background: #d97706;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(245, 158, 11, 0.4);
        }

        .footer {
            padding: 30px;
            background: #f8fafc;
            border-top: 2px solid #e2e8f0;
            display: flex;
            gap: 16px;
            justify-content: center;
        }

        .info-box {
            padding: 16px;
            border-radius: 8px;
            border: 2px solid;
            margin-top: 20px;
        }

        .info-box.yellow {
            background: #fef3c7;
            border-color: #fde047;
        }

        .info-box.red {
            background: #fef2f2;
            border-color: #fecaca;
        }

        .dose-display {
            font-size: 24px;
            font-weight: 700;
            color: #dc2626;
            margin-bottom: 4px;
        }

        .med-item {
            padding: 12px;
            border-radius: 8px;
            border: 2px solid;
            margin-bottom: 12px;
        }

        .med-item.given {
            background: #d1fae5;
            border-color: #6ee7b7;
        }

        .med-item.not-given {
            background: white;
            border-color: #99f6e4;
        }

        .med-inputs {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 8px;
        }

        .med-inputs select,
        .med-inputs input {
            padding: 10px;
            font-size: 13px;
            font-weight: 600;
            border: 2px solid #6ee7b7;
            border-radius: 6px;
            background: white;
        }
        
        .med-inputs select {
            cursor: pointer;
            color: #065f46;
        }
        
        .med-inputs select:hover {
            border-color: #10b981;
            background: #f0fdf4;
        }

        @media print {
            body { background: white; padding: 0; }
            .container { box-shadow: none; }
            .btn, .footer { display: none !important; }
        }

        @media (max-width: 1200px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .header button {
                width: 100%;
            }
            
            .footer {
                flex-direction: column;
                gap: 12px;
            }
            
            .footer button {
                width: 100%;
            }
            
            .form-grid {
                grid-template-columns: 1fr !important;
            }
            
            .time-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .time-row span {
                text-align: left;
                margin-top: 5px;
            }
            
            #recomendacionesPanel, #recordatoriosPanel {
                padding: 15px;
            }
            
            #recomendacionesPanel h3, #recordatoriosPanel h3 {
                font-size: 16px;
            }
            
            .med-inputs {
                grid-template-columns: 1fr !important;
            }
        }

        .help-tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 15px;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.2s;
        }

        .help-tab:hover {
            color: #2a5298;
            background: #f1f5f9;
        }

        .help-tab.active {
            color: #2a5298;
            border-bottom-color: #2a5298;
        }

        .help-content {
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ecg-pattern {
            margin-bottom: 25px;
        }

        .ecg-pattern h3 {
            color: #1e293b;
            font-size: 18px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e2e8f0;
        }

        .pattern-box {
            padding: 20px;
            border-radius: 12px;
            border: 2px solid;
            line-height: 1.6;
        }

        .pattern-box.critical {
            background: #fef2f2;
            border-color: #fca5a5;
        }

        .pattern-box.warning {
            background: #fffbeb;
            border-color: #fcd34d;
        }

        .pattern-box.info {
            background: #eff6ff;
            border-color: #93c5fd;
        }

        .pattern-box ul {
            margin: 10px 0;
            padding-left: 25px;
        }

        .pattern-box li {
            margin: 6px 0;
        }

        .pattern-box p {
            margin: 10px 0;
        }

        .flowchart {
            background: white;
            padding: 30px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
        }

        .flow-step {
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 15px;
            margin: 10px auto;
            max-width: 400px;
        }

        .flow-step.decision {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: white;
            border: 3px solid #d97706;
        }

        .flow-step.action-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border: 3px solid #1d4ed8;
        }

        .flow-step.action-fibrinolysis {
            background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);
            color: white;
            border: 3px solid #be185d;
        }

        .flow-arrow {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            color: #475569;
            margin: 10px 0;
        }

        .flow-arrow-small {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #475569;
            margin: 5px 0;
        }

        .sgarbossa-criteria {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .criteria-item {
            display: flex;
            gap: 20px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .criteria-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .criteria-item.modified {
            border-color: #10b981;
            background: #f0fdf4;
        }

        .criteria-points {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 24px;
            font-weight: 700;
            min-width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            flex-shrink: 0;
        }

        .criteria-item.modified .criteria-points {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .criteria-content {
            flex: 1;
        }

        .criteria-content h4 {
            color: #1e293b;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .criteria-content p {
            color: #475569;
            margin: 8px 0;
            font-size: 14px;
        }

        .criteria-note {
            margin-top: 10px;
            padding: 10px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 13px;
        }

        .criteria-note {
            background: #e0f2fe;
            color: #075985;
        }

        .criteria-note.warning {
            background: #fef3c7;
            color: #854d0e;
        }

        .criteria-note.success {
            background: #dcfce7;
            color: #166534;
        }

        .protocol-timeline {
            position: relative;
            padding-left: 60px;
        }

        .protocol-timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(180deg, #3b82f6 0%, #8b5cf6 100%);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
        }

        .timeline-number {
            position: absolute;
            left: -60px;
            top: 20px;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
            border: 4px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .timeline-content h4 {
            color: #1e293b;
            font-size: 18px;
            margin-bottom: 12px;
        }

        .timeline-content ul {
            margin: 10px 0;
            padding-left: 25px;
        }

        .timeline-content li {
            margin: 8px 0;
            color: #475569;
            line-height: 1.6;
        }

        .timeline-content p {
            color: #1e293b;
            font-weight: 600;
            margin: 12px 0 8px 0;
        }

        /* Language Switcher */
        .language-switcher {
            display: flex;
            gap: 8px;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .language-flag {
            width: 36px;
            height: 36px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .language-flag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .language-flag.active {
            border-color: white;
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.3);
        }

        .language-flag:active {
            transform: translateY(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1 data-i18n="app.title">Dashboard C√≥digo IAM</h1>
                <p data-i18n="app.subtitle">Atenci√≥n Primaria - Protocolo actualizado 2023</p>
            </div>
            <div style="display: flex; align-items: center; gap: 20px;">
                <!-- Language Switcher -->
                <div class="language-switcher">
                    <div class="language-flag active" data-lang="ca" onclick="i18n.changeLanguage('ca')" title="Catal√†">
                        <svg width="24" height="24" viewBox="0 0 24 24" style="border-radius: 2px;">
                            <rect width="24" height="5.33" fill="#FCDD09"/>
                            <rect y="5.33" width="24" height="5.33" fill="#DA121A"/>
                            <rect y="10.66" width="24" height="5.33" fill="#FCDD09"/>
                            <rect y="16" width="24" height="5.33" fill="#DA121A"/>
                            <rect y="21.33" width="24" height="2.67" fill="#FCDD09"/>
                        </svg>
                    </div>
                    <div class="language-flag" data-lang="es" onclick="i18n.changeLanguage('es')" title="Espa√±ol">
                        üá™üá∏
                    </div>
                    <div class="language-flag" data-lang="fr" onclick="i18n.changeLanguage('fr')" title="Fran√ßais">
                        üá´üá∑
                    </div>
                    <div class="language-flag" data-lang="en" onclick="i18n.changeLanguage('en')" title="English">
                        üá¨üáß
                    </div>
                </div>
                <button onclick="toggleHelp()" style="padding: 12px 24px; background: rgba(255,255,255,0.2); color: white; border: 2px solid white; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                    <span data-i18n="btn.help">üìö Gu√≠a de Ayuda</span>
                </button>
                <div class="clock">
                    <div class="time" id="currentTime"></div>
                    <div class="date" id="currentDate"></div>
                </div>
            </div>
        </div>

        <!-- Modal de Ayuda -->
        <div id="helpModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 1000; overflow-y: auto; padding: 20px;">
            <div style="max-width: 1200px; margin: 0 auto; background: white; border-radius: 16px; padding: 30px; position: relative;">
                <button onclick="toggleHelp()" style="position: absolute; top: 20px; right: 20px; width: 40px; height: 40px; border-radius: 50%; background: #ef4444; color: white; border: none; font-size: 20px; cursor: pointer; font-weight: bold;">√ó</button>
                
                <h1 style="color: #1e3c72; margin-bottom: 30px; font-size: 28px;">üìö Gu√≠a de Ayuda - C√≥digo IAM</h1>

                <!-- Tabs -->
                <div style="display: flex; gap: 10px; margin-bottom: 30px; border-bottom: 2px solid #e2e8f0;">
                    <button class="help-tab active" onclick="showHelpTab('patrones')" data-tab="patrones">Patrones ECG</button>
                    <button class="help-tab" onclick="showHelpTab('algoritmo')" data-tab="algoritmo">Algoritmo Decisi√≥n</button>
                    <button class="help-tab" onclick="showHelpTab('sgarbossa')" data-tab="sgarbossa">Criterios Sgarbossa</button>
                    <button class="help-tab" onclick="showHelpTab('protocolo')" data-tab="protocolo">Protocolo Codi IAM</button>
                </div>

                <!-- Tab: Patrones ECG -->
                <div id="tab-patrones" class="help-content">
                    <h2 style="color: #2a5298; margin-bottom: 20px;">üîç Identificaci√≥n de Patrones Electrocardiogr√°ficos</h2>
                    
                    <div class="ecg-pattern">
                        <h3>‚ö†Ô∏è Patr√≥n de De Winter (NUEVO 2023)</h3>
                        <div class="pattern-box critical">
                            <div style="font-weight: 700; font-size: 18px; color: #dc2626; margin-bottom: 10px;">
                                ¬°EQUIVALENTE A STEMI! - Requiere activaci√≥n inmediata
                            </div>
                            <p><strong>Hallazgos clave:</strong></p>
                            <ul>
                                <li>Depresi√≥n del ST de 1-3 mm en derivaciones precordiales (V2-V6)</li>
                                <li>Ondas T altas, sim√©tricas y prominentes</li>
                                <li>Elevaci√≥n del ST peque√±a (0.5-1 mm) en aVR</li>
                                <li><strong>NO hay elevaci√≥n del ST en precordiales</strong></li>
                            </ul>
                            <p><strong>Significado cl√≠nico:</strong></p>
                            <p>Indica oclusi√≥n proximal de la arteria descendente anterior izquierda (LAD). Es un patr√≥n DIN√ÅMICO que puede evolucionar r√°pidamente a STEMI cl√°sico.</p>
                            <p style="background: #fef2f2; padding: 10px; border-radius: 6px; border-left: 4px solid #dc2626; margin-top: 10px;">
                                <strong>‚ö†Ô∏è ACCI√ìN:</strong> Activar C√≥digo IAM inmediatamente aunque NO haya elevaci√≥n del ST t√≠pica.
                            </p>
                        </div>
                    </div>

                    <div class="ecg-pattern">
                        <h3>üìä Depresi√≥n ST difusa + Elevaci√≥n aVR</h3>
                        <div class="pattern-box warning">
                            <p><strong>Hallazgos clave:</strong></p>
                            <ul>
                                <li>Depresi√≥n del ST ‚â•1 mm en ‚â•8 derivaciones</li>
                                <li>Elevaci√≥n del ST en aVR (‚â•1 mm)</li>
                                <li>Puede haber elevaci√≥n en V1</li>
                            </ul>
                            <p><strong>Significado cl√≠nico:</strong></p>
                            <p>Sugiere enfermedad del tronco coronario izquierdo o enfermedad multivaso grave. Pron√≥stico muy grave.</p>
                        </div>
                    </div>

                    <div class="ecg-pattern">
                        <h3>üîÑ Infarto Posterior</h3>
                        <div class="pattern-box info">
                            <p><strong>Hallazgos clave:</strong></p>
                            <ul>
                                <li>Onda R alta en V1-V2 (imagen especular de onda Q)</li>
                                <li>Depresi√≥n del ST en V1-V3 (imagen especular de elevaci√≥n)</li>
                                <li>Onda T positiva alta en V1-V2</li>
                                <li><strong>Confirmaci√≥n:</strong> Elevaci√≥n del ST >0.5 mm en V7-V9</li>
                            </ul>
                            <p><strong>Acci√≥n:</strong> Realizar derivaciones posteriores (V7, V8, V9) para confirmar.</p>
                        </div>
                    </div>

                    <div class="ecg-pattern">
                        <h3>‚û°Ô∏è Infarto de Ventr√≠culo Derecho</h3>
                        <div class="pattern-box info">
                            <p><strong>Hallazgos clave:</strong></p>
                            <ul>
                                <li>Elevaci√≥n del ST en derivaciones inferiores (II, III, aVF)</li>
                                <li>Elevaci√≥n del ST en V1 y derivaciones derechas (V3R, V4R)</li>
                                <li>V4R es la m√°s sensible y espec√≠fica</li>
                            </ul>
                            <p><strong>Importancia cl√≠nica:</strong></p>
                            <p>Asociado a IAM inferior. Mayor riesgo de hipotensi√≥n, bradiarritmias y shock. <strong>Contraindicaci√≥n relativa para nitratos.</strong></p>
                        </div>
                    </div>

                    <div class="ecg-pattern">
                        <h3>üîÄ STEMI con Bloqueo de Rama</h3>
                        <div class="pattern-box warning">
                            <p><strong>Desaf√≠o diagn√≥stico:</strong></p>
                            <p>El bloqueo de rama (especialmente BRIHH) dificulta la interpretaci√≥n del ST. Usar criterios de Sgarbossa-Smith (ver pesta√±a espec√≠fica).</p>
                            <p><strong>Puntos clave:</strong></p>
                            <ul>
                                <li>BRIHH de nueva aparici√≥n = considerar equivalente a STEMI</li>
                                <li>BRDHH: menos interferencia, m√°s f√°cil de interpretar</li>
                                <li>Aplicar score de Sgarbossa (‚â•3 puntos = probable IAM)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Tab: Algoritmo -->
                <div id="tab-algoritmo" class="help-content" style="display: none;">
                    <h2 style="color: #2a5298; margin-bottom: 20px;">üéØ Algoritmo de Decisi√≥n de Estrategia de Reperfusi√≥n</h2>
                    
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <h3 style="margin-bottom: 15px; font-size: 20px;">¬øEl paciente cumple criterios de C√≥digo IAM?</h3>
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px;">
                            <p style="margin-bottom: 10px;"><strong>‚úì STEMI:</strong> Elevaci√≥n ST, De Winter, depresi√≥n difusa+aVR, posterior, VD, BRIHH nuevo</p>
                            <p><strong>‚úì NSTEMI muy alto riesgo:</strong> Shock (TAS &lt;90), dolor refractario</p>
                        </div>
                    </div>

                    <div class="flowchart">
                        <div class="flow-step decision">
                            <strong>¬øC√≥digo IAM Activado?</strong>
                        </div>
                        <div class="flow-arrow">‚Üì S√ç</div>
                        
                        <div class="flow-step decision">
                            <strong>¬øTiempo esperado de traslado + tiempo puerta-bal√≥n &lt;120 min?</strong>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                            <div>
                                <div class="flow-arrow">‚Üì S√ç</div>
                                <div class="flow-step action-primary">
                                    <strong>ANGIOPLASTIA PRIMARIA</strong>
                                    <hr style="margin: 10px 0; border: none; border-top: 1px solid rgba(255,255,255,0.3);">
                                    <p style="font-size: 13px; margin: 0;">
                                        ‚Ä¢ Aspirina 300 mg VO<br>
                                        ‚Ä¢ Segundo antiagregante seg√∫n algoritmo<br>
                                        ‚Ä¢ Heparina no fraccionada o enoxaparina<br>
                                        ‚Ä¢ Activar sala de hemodin√°mica<br>
                                        ‚Ä¢ Traslado urgente
                                    </p>
                                </div>
                            </div>
                            
                            <div>
                                <div class="flow-arrow">‚Üì NO</div>
                                <div class="flow-step decision">
                                    <strong>¬øContraindicaciones para fibrin√≥lisis?</strong>
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
                                    <div>
                                        <div class="flow-arrow-small">‚Üì NO</div>
                                        <div class="flow-step action-fibrinolysis">
                                            <strong>FIBRIN√ìLISIS</strong>
                                            <hr style="margin: 10px 0;">
                                            <p style="font-size: 12px; margin: 0;">
                                                ‚Ä¢ Aspirina 300 mg<br>
                                                ‚Ä¢ Clopidogrel 300 mg<br>
                                                ‚Ä¢ TNK seg√∫n peso<br>
                                                ‚Ä¢ Enoxaparina<br>
                                                ‚Ä¢ Traslado post-TNK
                                            </p>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flow-arrow-small">‚Üì S√ç</div>
                                        <div class="flow-step action-primary">
                                            <strong>ICP</strong>
                                            <hr style="margin: 10px 0;">
                                            <p style="font-size: 12px; margin: 0;">
                                                Traslado urgente para angioplastia aunque &gt;120 min
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="background: #fef3c7; padding: 20px; border-radius: 12px; border: 2px solid #fde047; margin-top: 30px;">
                        <h3 style="color: #854d0e; margin-bottom: 15px;">üìã Contraindicaciones ABSOLUTAS para Fibrin√≥lisis:</h3>
                        <ul style="color: #854d0e; line-height: 1.8;">
                            <li>Hemorragia cerebral previa (cualquier momento)</li>
                            <li>AVC isqu√©mico &lt;6 meses</li>
                            <li>Lesi√≥n/neoplasia del SNC</li>
                            <li>Traumatismo mayor/cirug√≠a/trauma craneal &lt;3 meses</li>
                            <li>Sangrado activo o di√°tesis hemorr√°gica</li>
                            <li>Sospecha disecci√≥n a√≥rtica</li>
                            <li>HTA refractaria (&gt;180/110 mmHg)</li>
                        </ul>
                    </div>
                </div>

                <!-- Tab: Sgarbossa -->
                <div id="tab-sgarbossa" class="help-content" style="display: none;">
                    <h2 style="color: #2a5298; margin-bottom: 20px;">üî¨ Criterios de Sgarbossa-Smith</h2>
                    
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <h3 style="margin-bottom: 10px;">Para diagn√≥stico de IAM en presencia de BRIHH o ritmo de marcapasos</h3>
                        <p style="font-size: 14px; opacity: 0.9;">Desarrollado porque el BRIHH dificulta la interpretaci√≥n del segmento ST</p>
                    </div>

                    <div class="sgarbossa-criteria">
                        <div class="criteria-item">
                            <div class="criteria-points">5 puntos</div>
                            <div class="criteria-content">
                                <h4>Elevaci√≥n del ST concordante ‚â•1 mm</h4>
                                <p>Elevaci√≥n del ST en la misma direcci√≥n (concordante) que el complejo QRS.</p>
                                <p><strong>Ejemplo:</strong> En derivaci√≥n con QRS positivo (hacia arriba), el ST tambi√©n est√° elevado hacia arriba.</p>
                                <div class="criteria-note">Altamente espec√≠fico para IAM</div>
                            </div>
                        </div>

                        <div class="criteria-item">
                            <div class="criteria-points">3 puntos</div>
                            <div class="criteria-content">
                                <h4>Depresi√≥n del ST concordante ‚â•1 mm en V1-V3</h4>
                                <p>Depresi√≥n del ST en V1, V2 o V3, concordante con el QRS.</p>
                                <div class="criteria-note">Muy espec√≠fico - indica IAM posterior o lateral</div>
                            </div>
                        </div>

                        <div class="criteria-item">
                            <div class="criteria-points">2 puntos</div>
                            <div class="criteria-content">
                                <h4>Elevaci√≥n del ST discordante ‚â•5 mm (Criterio original)</h4>
                                <p>Elevaci√≥n del ST en direcci√≥n opuesta al QRS, pero de gran magnitud.</p>
                                <div class="criteria-note warning">‚ö†Ô∏è Criterio original modificado por Smith</div>
                            </div>
                        </div>

                        <div class="criteria-item modified">
                            <div class="criteria-points">‚â•25%</div>
                            <div class="criteria-content">
                                <h4>Criterio Modificado de Smith (2012)</h4>
                                <p><strong>Elevaci√≥n del ST ‚â•25% de la amplitud del QRS</strong></p>
                                <p>M√°s sensible que el criterio de Sgarbossa original.</p>
                                <p><strong>C√°lculo:</strong> (Elevaci√≥n ST / Amplitud S) √ó 100 ‚â• 25%</p>
                                <div class="criteria-note success">‚úì Recomendado usar este criterio en lugar del original de 5mm</div>
                            </div>
                        </div>
                    </div>

                    <div style="background: #e0f2fe; padding: 20px; border-radius: 12px; border: 2px solid #7dd3fc; margin-top: 30px;">
                        <h3 style="color: #0369a1; margin-bottom: 15px;">üìä Interpretaci√≥n del Score:</h3>
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                            <p style="color: #0c4a6e; margin: 0;"><strong>‚â•3 puntos:</strong> Alta probabilidad de IAM agudo ‚Üí Activar C√≥digo IAM</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <p style="color: #0c4a6e; margin: 0;"><strong>&lt;3 puntos:</strong> Probabilidad baja (pero no excluye) ‚Üí Valorar cl√≠nica, biomarcadores, ecocardiograf√≠a</p>
                        </div>
                    </div>

                    <div style="background: #fef2f2; padding: 20px; border-radius: 12px; border: 2px solid #fecaca; margin-top: 20px;">
                        <h3 style="color: #991b1b; margin-bottom: 15px;">‚ö†Ô∏è Importante:</h3>
                        <ul style="color: #991b1b; line-height: 1.8;">
                            <li>Los criterios de Sgarbossa son MUY ESPEC√çFICOS pero poco SENSIBLES</li>
                            <li>Un score bajo NO excluye IAM - considerar siempre el contexto cl√≠nico</li>
                            <li>BRIHH de nueva aparici√≥n = considerar equivalente a STEMI</li>
                            <li>En caso de duda con BRIHH: comparar con ECG previos si disponibles</li>
                        </ul>
                    </div>
                </div>

                <!-- Tab: Protocolo -->
                <div id="tab-protocolo" class="help-content" style="display: none;">
                    <h2 style="color: #2a5298; margin-bottom: 20px;">üìã Protocolo Codi IAM - Actuaci√≥n en Atenci√≥n Primaria</h2>
                    
                    <div class="protocol-timeline">
                        <div class="timeline-item">
                            <div class="timeline-number">1</div>
                            <div class="timeline-content">
                                <h4>Primer Contacto (&lt;10 min)</h4>
                                <ul>
                                    <li>Evaluaci√≥n r√°pida: dolor tor√°cico, disnea, s√≠ncope</li>
                                    <li>Constantes vitales: TA, FC, SpO‚ÇÇ</li>
                                    <li>Monitorizaci√≥n continua</li>
                                    <li>Acceso venoso perif√©rico</li>
                                    <li><strong>ECG de 12 derivaciones inmediato</strong></li>
                                </ul>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-number">2</div>
                            <div class="timeline-content">
                                <h4>Interpretaci√≥n ECG y Decisi√≥n seg√∫n Cl√≠nica</h4>
                                
                                <div style="background: #dcfce7; padding: 15px; border-radius: 8px; border-left: 4px solid #22c55e; margin-bottom: 15px;">
                                    <h5 style="color: #166534; margin: 0 0 10px 0; font-size: 16px;">‚úÖ CL√çNICA T√çPICA + ECG compatible</h5>
                                    <ul style="margin: 0; padding-left: 20px; color: #166534;">
                                        <li>Dolor opresivo >20 minutos</li>
                                        <li>Irradiaci√≥n a brazo izquierdo/mand√≠bula</li>
                                        <li>Cortejo vegetativo (sudoraci√≥n, n√°useas)</li>
                                        <li>No responde a NTG</li>
                                    </ul>
                                    <div style="background: #22c55e; color: white; padding: 12px; border-radius: 6px; margin-top: 10px; font-weight: 700; text-align: center;">
                                        ‚Üí ACTIVAR C√ìDIGO IAM INMEDIATAMENTE
                                    </div>
                                    <p style="margin: 10px 0 0 0; font-size: 13px; color: #166534;">
                                        <strong>NO ESPERAR ECG de control.</strong> El tiempo es m√∫sculo.
                                    </p>
                                </div>
                                
                                <div style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #eab308; margin-bottom: 15px;">
                                    <h5 style="color: #854d0e; margin: 0 0 10px 0; font-size: 16px;">‚ö†Ô∏è CL√çNICA AT√çPICA o DUDOSA + ECG</h5>
                                    <ul style="margin: 0; padding-left: 20px; color: #854d0e;">
                                        <li>Dolor at√≠pico (breve, punzante, localizado)</li>
                                        <li>Paciente muy joven sin factores de riesgo</li>
                                        <li>Dolor nocturno en reposo (sospecha espasmo)</li>
                                        <li>Cambios ECG borderline o dudosos</li>
                                    </ul>
                                    <div style="background: white; padding: 12px; border-radius: 6px; margin-top: 10px; border: 2px solid #eab308;">
                                        <p style="margin: 0; color: #854d0e; font-weight: 600;">
                                            1. Administrar NTG sublingual<br>
                                            2. ECG de control a los 15 minutos<br>
                                            3. Si persiste elevaci√≥n ‚Üí Activar c√≥digo
                                        </p>
                                    </div>
                                </div>
                                
                                <div style="background: #fee2e2; padding: 15px; border-radius: 8px; border-left: 4px solid #dc2626;">
                                    <h5 style="color: #991b1b; margin: 0 0 10px 0; font-size: 16px;">üö® MUY ALTO RIESGO</h5>
                                    <p style="margin: 0 0 10px 0; color: #991b1b;">
                                        <strong>Activaci√≥n INMEDIATA independientemente de ECG o cl√≠nica:</strong>
                                    </p>
                                    <ul style="margin: 0; padding-left: 20px; color: #991b1b;">
                                        <li>Shock cardiog√©nico (detectado autom√°ticamente si TAS &lt;90 mmHg)</li>
                                        <li>Dolor refractario a tratamiento</li>
                                        <li>Insuficiencia card√≠aca aguda</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-number">3</div>
                            <div class="timeline-content">
                                <h4>Tratamiento Inicial (Antes del Traslado)</h4>
                                <ul>
                                    <li><strong>AAS 300 mg VO</strong> (masticar) - Lo antes posible</li>
                                    <li><strong>Nitroglicerina sublingual</strong> (si TA adecuada, no en IAM VD) - Para valorar respuesta</li>
                                    <li><strong>Segundo antiagregante</strong> seg√∫n algoritmo (tras confirmar elevaci√≥n persistente)</li>
                                    <li>Morfina 3-5 mg IV si dolor persistente (y TAS >90)</li>
                                    <li>Ox√≠geno solo si SpO‚ÇÇ &lt;90%</li>
                                </ul>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-number">4</div>
                            <div class="timeline-content">
                                <h4>Estrategia seg√∫n Distancia y Contraindicaciones</h4>
                                <p><strong>Centro con Hemodin√°mica &lt;120 min:</strong></p>
                                <ul>
                                    <li>Traslado para angioplastia primaria</li>
                                    <li>SEM se hace cargo del paciente</li>
                                </ul>
                                <p><strong>Centro con Hemodin√°mica &gt;120 min y sin contraindicaciones:</strong></p>
                                <ul>
                                    <li>Valorar fibrin√≥lisis in situ</li>
                                    <li>TNK seg√∫n peso, clopidogrel 300 mg, enoxaparina</li>
                                    <li>Traslado post-fibrin√≥lisis para angiograf√≠a</li>
                                </ul>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-number">5</div>
                            <div class="timeline-content">
                                <h4>Durante el Traslado</h4>
                                <ul>
                                    <li>Monitorizaci√≥n continua</li>
                                    <li>Mantener v√≠a venosa permeable</li>
                                    <li>ECG seriados si disponible</li>
                                    <li>Anticipar complicaciones (arritmias, shock)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div style="background: #dcfce7; padding: 20px; border-radius: 12px; border: 2px solid #86efac; margin-top: 30px;">
                        <h3 style="color: #166534; margin-bottom: 15px;">‚úÖ Objetivos del C√≥digo IAM:</h3>
                        <ul style="color: #166534; line-height: 1.8;">
                            <li><strong>ECG-Bal√≥n &lt;120 minutos</strong> (objetivo &lt;90 min)</li>
                            <li><strong>Puerta-TNK &lt;30 minutos</strong> si fibrin√≥lisis</li>
                            <li>Reperfusi√≥n universal (100% pacientes con indicaci√≥n)</li>
                            <li>Reducci√≥n de mortalidad y complicaciones</li>
                        </ul>
                    </div>

                    <div style="background: #fff7ed; padding: 20px; border-radius: 12px; border: 2px solid #fed7aa; margin-top: 20px;">
                        <h3 style="color: #9a3412; margin-bottom: 15px;">üìû Hospitales de Referencia en Catalu√±a:</h3>
                        <p style="color: #9a3412;">La regi√≥n est√° dividida en 10 √°reas, cada una con un hospital de referencia con sala de hemodin√°mica 24/7. El SEM (061) coordinar√° el traslado al hospital correspondiente seg√∫n zona geogr√°fica y disponibilidad.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="content">
            <!-- Columna Izquierda -->
            <div>
                <!-- Datos del Paciente -->
                <div class="section section-patient">
                    <h2 data-i18n="section.patient">üë§ Datos del Paciente</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label data-i18n="patient.age">Edad (a√±os)</label>
                            <input type="number" id="edad" data-i18n-placeholder="patient.age.placeholder" placeholder="A√±os" onchange="updateContraindications()">
                        </div>
                        <div class="form-group">
                            <label data-i18n="patient.weight">Peso (kg)</label>
                            <input type="number" id="peso" data-i18n-placeholder="patient.weight.placeholder" placeholder="kg" onchange="calculateTNK()">
                        </div>
                        <div class="form-group">
                            <label data-i18n="patient.gender">Sexo</label>
                            <select id="sexo">
                                <option value="M" data-i18n-value="patient.gender.male">Masculino</option>
                                <option value="F" data-i18n-value="patient.gender.female">Femenino</option>
                            </select>
                        </div>
                        <div class="form-group full">
                            <label data-i18n="clinical.allergies">Alergias conocidas</label>
                            <input type="text" id="alergias" data-i18n-placeholder="clinical.allergies.placeholder" placeholder="Ninguna conocida">
                        </div>
                        <div class="form-group full">
                            <label style="display: flex; align-items: center; gap: 10px; padding: 12px; background: #fff7ed; border-radius: 8px; border: 2px solid #fed7aa; cursor: pointer;">
                                <input type="checkbox" id="anticoagulacion" style="width: 18px; height: 18px;">
                                <span style="font-weight: 600; color: #ea580c;" data-i18n="patient.anticoagulation">Anticoagulaci√≥n oral activa</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Cronolog√≠a -->
                <div class="section section-timeline" style="margin-top: 20px;">
                    <h2 data-i18n="section.timeline">üïê Cronolog√≠a</h2>
                    
                    <div style="background: #dcfce7; padding: 12px; border-radius: 8px; border-left: 4px solid #22c55e; margin-bottom: 15px; font-size: 13px; color: #166534;">
                        <span data-i18n="timeline.pragmatic.info"><strong>üí° Criterio pragm√°tico:</strong> Si cl√≠nica T√çPICA + ECG compatible ‚Üí ACTIVAR YA (no esperar ECG control). ECG control solo en casos DUDOSOS.</span>
                    </div>

                    <div class="time-row">
                        <input type="time" id="inicioSintomas">
                        <button class="btn" onclick="markTime('inicioSintomas')" data-i18n="btn.now">Ahora</button>
                        <span style="font-size: 13px; color: #16a34a; min-width: 160px;" data-i18n="timeline.symptom.onset">Inicio de s√≠ntomas</span>
                    </div>
                    <div class="time-row">
                        <input type="time" id="primerContacto">
                        <button class="btn" onclick="markTime('primerContacto')" data-i18n="btn.now">Ahora</button>
                        <span style="font-size: 13px; color: #16a34a; min-width: 160px;" data-i18n="timeline.first.contact">Primer contacto m√©dico</span>
                    </div>
                    <div class="time-row">
                        <input type="time" id="ecgRealizado">
                        <button class="btn" onclick="markTime('ecgRealizado')" data-i18n="btn.now">Ahora</button>
                        <span style="font-size: 13px; color: #16a34a; min-width: 160px;" data-i18n="timeline.ecg.initial">ECG inicial realizado</span>
                    </div>
                    <div class="time-row">
                        <input type="time" id="ecgControl">
                        <button class="btn" onclick="markTime('ecgControl')" data-i18n="btn.now">Ahora</button>
                        <span style="font-size: 13px; color: #ea580c; min-width: 160px;" data-i18n="timeline.ecg.control">ECG control (15 min post-NTG)</span>
                    </div>
                    <div class="time-row">
                        <input type="time" id="activacionCodigo">
                        <button class="btn" onclick="markTime('activacionCodigo')" data-i18n="btn.now">Ahora</button>
                        <span style="font-size: 13px; color: #dc2626; min-width: 160px; font-weight: 700;" data-i18n="timeline.activation">Activaci√≥n C√≥digo IAM</span>
                    </div>
                </div>

                <!-- Hallazgos ECG -->
                <div class="section section-ecg" style="margin-top: 20px;">
                    <h2 data-i18n="section.ecg">üìä Hallazgos Electrocardiogr√°ficos</h2>
                    
                    <div class="checkbox-item" style="border-color: #fde047;" onclick="toggleCheck('elevacionST')">
                        <input type="checkbox" id="elevacionST" onclick="event.stopPropagation(); checkActivation()">
                        <span data-i18n="ecg.st.elevation">Elevaci√≥n del segmento ST</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fca5a5; background: #fee2e2;" onclick="toggleCheck('patronWinter')">
                        <input type="checkbox" id="patronWinter" onclick="event.stopPropagation(); checkActivation()">
                        <span style="color: #dc2626; font-weight: 600;" data-i18n="ecg.winter.pattern">‚ö†Ô∏è Patr√≥n de De Winter (Equivalente STEMI)</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fca5a5; background: #fee2e2;" onclick="toggleCheck('depresionSTconAVR')">
                        <input type="checkbox" id="depresionSTconAVR" onclick="event.stopPropagation(); checkActivation()">
                        <span style="color: #dc2626; font-weight: 600;" data-i18n="ecg.st.depression.avr">Depresi√≥n ST difusa + elevaci√≥n aVR</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fde047;" onclick="toggleCheck('infartoPosterior')">
                        <input type="checkbox" id="infartoPosterior" onclick="event.stopPropagation(); checkActivation()">
                        <span data-i18n="ecg.posterior.infarction">Infarto posterior</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fde047;" onclick="toggleCheck('infartoVD')">
                        <input type="checkbox" id="infartoVD" onclick="event.stopPropagation(); checkActivation(); updateRecomendaciones();">
                        <span data-i18n="ecg.right.ventricle">‚ö†Ô∏è Infarto ventr√≠culo derecho</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fde047;" onclick="toggleCheck('bbefh')">
                        <input type="checkbox" id="bbefh" onclick="event.stopPropagation(); checkActivation()">
                        <span data-i18n="ecg.new.lbbb">BBEFH de nueva aparici√≥n</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fde047;" onclick="toggleCheck('bbdfh')">
                        <input type="checkbox" id="bbdfh" onclick="event.stopPropagation(); checkActivation()">
                        <span data-i18n="ecg.new.rbbb">BBDFH de nueva aparici√≥n</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fde047;" onclick="toggleCheck('marcapassos')">
                        <input type="checkbox" id="marcapassos" onclick="event.stopPropagation(); checkActivation()">
                        <span data-i18n="ecg.pacemaker">Ritmo de marcapassos</span>
                    </div>

                    <textarea id="otrosECG" data-i18n-placeholder="ecg.other.findings" placeholder="Otros hallazgos ECG..." style="border-color: #fde047; margin-top: 10px;"></textarea>
                </div>

                <!-- Alerta de activaci√≥n -->
                <div id="alertaActivacion" style="display: none;" class="alert-box">
                    <div class="icon">‚ö†Ô∏è</div>
                    <div>
                        <div class="text" data-i18n="ecg.alert.st.detected">¬°Elevaci√≥n del ST detectada!</div>
                        <div style="font-size: 14px; color: #991b1b;" id="alertaTexto" data-i18n="ecg.alert.ntg.instructions">
                            Administrar NTG y realizar ECG de control a los 15 min para confirmar elevaci√≥n PERSISTENTE
                        </div>
                    </div>
                </div>
            </div>

            <!-- Columna Derecha -->
            <div>
                <!-- Datos Cl√≠nicos -->
                <div class="section section-clinical">
                    <h2 data-i18n="section.clinical">üè• Datos Cl√≠nicos</h2>
                    
                    <div style="background: #fef3c7; padding: 16px; border-radius: 8px; border: 2px solid #fde047; margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 700; color: #854d0e; font-size: 15px;" data-i18n="clinical.typical.question">
                            ¬øCl√≠nica T√çPICA de IAM?
                        </label>
                        <div style="display: flex; gap: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; background: white; padding: 10px 16px; border-radius: 6px; border: 2px solid #fde047; flex: 1;">
                                <input type="radio" name="clinicaIAM" id="clinicaSi" value="si" style="width: 18px; height: 18px; cursor: pointer;" onchange="checkActivation()">
                                <span style="font-weight: 600; color: #854d0e;" data-i18n="clinical.typical.yes">S√ç - T√≠pica</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; background: white; padding: 10px 16px; border-radius: 6px; border: 2px solid #fde047; flex: 1;">
                                <input type="radio" name="clinicaIAM" id="clinicaNo" value="no" style="width: 18px; height: 18px; cursor: pointer;" onchange="checkActivation()">
                                <span style="font-weight: 600; color: #854d0e;" data-i18n="clinical.typical.no">NO - At√≠pica/Dudosa</span>
                            </label>
                        </div>
                        <div style="font-size: 12px; color: #92400e; margin-top: 8px; line-height: 1.4;">
                            <span data-i18n="clinical.typical.description"><strong>T√≠pica:</strong> Dolor opresivo >20 min, irradiaci√≥n a brazo/mand√≠bula, cortejo vegetativo, no responde a NTG<br>
                            <strong>At√≠pica:</strong> Dolor breve, localizaci√≥n at√≠pica, paciente muy joven, dudas diagn√≥sticas</span>
                        </div>
                    </div>
                    
                    <div class="form-grid" style="margin-bottom: 16px;">
                        <div class="form-group">
                            <label data-i18n="clinical.sbp">TAS (mmHg)</label>
                            <input type="number" id="tas" data-i18n-placeholder="clinical.sbp.placeholder" placeholder="mmHg">
                        </div>
                        <div class="form-group">
                            <label data-i18n="clinical.dbp">TAD (mmHg)</label>
                            <input type="number" id="tad" data-i18n-placeholder="clinical.dbp.placeholder" placeholder="mmHg">
                        </div>
                        <div class="form-group">
                            <label data-i18n="clinical.hr">FC (lpm)</label>
                            <input type="number" id="fc" data-i18n-placeholder="clinical.hr.placeholder" placeholder="lpm">
                        </div>
                        <div class="form-group">
                            <label data-i18n="clinical.o2sat">SpO‚ÇÇ (%)</label>
                            <input type="number" id="spo2" data-i18n-placeholder="clinical.o2sat.placeholder" placeholder="%">
                        </div>
                        <div class="form-group full">
                            <label data-i18n="clinical.killip.class">Clasificaci√≥n Killip</label>
                            <select id="killip">
                                <option value="1" data-i18n-value="clinical.killip.1">I - Auscultaci√≥n normal</option>
                                <option value="2" data-i18n-value="clinical.killip.2">II - Crepitantes y/o 3er ruido</option>
                                <option value="3" data-i18n-value="clinical.killip.3">III - Edema agudo de pulm√≥n</option>
                                <option value="4" data-i18n-value="clinical.killip.4">IV - Shock cardiog√©nico</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="checkbox-item" style="border-color: #fca5a5; background: #fee2e2;" onclick="toggleCheck('dolorRefractario')">
                        <input type="checkbox" id="dolorRefractario" onclick="event.stopPropagation(); checkActivation()">
                        <span style="color: #dc2626; font-weight: 600;" data-i18n="clinical.refractory.pain">Dolor refractario a tratamiento</span>
                    </div>

                    <!-- Alerta autom√°tica de shock cardiog√©nico -->
                    <div id="alertaShock" style="display: none; background: #fee2e2; padding: 12px; border-radius: 8px; border: 2px solid #dc2626; margin-top: 10px;">
                        <div style="color: #dc2626; font-weight: 700; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                            <span>‚ö†Ô∏è</span>
                            <span data-i18n="clinical.shock.alert">Posible SHOCK CARDIOG√âNICO detectado</span>
                        </div>
                        <div style="color: #991b1b; font-size: 12px; margin-top: 6px;" data-i18n="clinical.shock.description">
                            TAS &lt;90 mmHg sugiere shock. Valorar cl√≠nica completa.
                        </div>
                    </div>
                </div>

                <!-- Panel de Recomendaciones Din√°micas -->
                <div id="recomendacionesPanel" style="display: none; background: white; border-radius: 12px; padding: 20px; border: 2px solid #3b82f6; margin-top: 20px;">
                    <h3 style="color: #1e3c72; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;" data-i18n="clinical.recommendations.title">
                        üí° Recomendaciones Cl√≠nicas
                    </h3>
                    <div id="recomendacionesList" style="display: flex; flex-direction: column; gap: 10px;">
                        <!-- Las recomendaciones se insertar√°n aqu√≠ din√°micamente -->
                    </div>
                </div>

                <!-- Panel de Recordatorios de Tiempo -->
                <div id="recordatoriosPanel" style="display: none; background: #fff7ed; border-radius: 12px; padding: 20px; border: 2px solid #fb923c; margin-top: 20px;">
                    <h3 style="color: #9a3412; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;" data-i18n="clinical.reminders.title">
                        ‚è∞ Recordatorios de Tiempo
                    </h3>
                    <div id="recordatoriosList" style="display: flex; flex-direction: column; gap: 10px;">
                        <!-- Los recordatorios se insertar√°n aqu√≠ din√°micamente -->
                    </div>
                </div>

                <!-- Contraindicaciones -->
                <div class="section section-contra" style="margin-top: 20px;">
                    <h2 data-i18n="section.contraindications">‚ö†Ô∏è Contraindicaciones para Fibrin√≥lisis</h2>
                    
                    <div class="checkbox-item" style="border-color: #fca5a5;" onclick="toggleCheck('hemorragiaCerebral')">
                        <input type="checkbox" id="hemorragiaCerebral" onclick="event.stopPropagation()">
                        <span style="font-size: 13px;" data-i18n="contra.cerebral.hemorrhage">Hemorragia cerebral previa</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fca5a5;" onclick="toggleCheck('avcReciente')">
                        <input type="checkbox" id="avcReciente" onclick="event.stopPropagation()">
                        <span style="font-size: 13px;" data-i18n="contra.recent.stroke">AVC isqu√©mico &lt;6 meses</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fca5a5;" onclick="toggleCheck('traumaCirugia')">
                        <input type="checkbox" id="traumaCirugia" onclick="event.stopPropagation()">
                        <span style="font-size: 13px;" data-i18n="contra.recent.trauma.surgery">Trauma/cirug√≠a reciente &lt;3 meses</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fca5a5;" onclick="toggleCheck('sangradoActivo')">
                        <input type="checkbox" id="sangradoActivo" onclick="event.stopPropagation()">
                        <span style="font-size: 13px;" data-i18n="contra.active.bleeding">Sangrado activo</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fca5a5;" onclick="toggleCheck('htaRefractaria')">
                        <input type="checkbox" id="htaRefractaria" onclick="event.stopPropagation()">
                        <span style="font-size: 13px;" data-i18n="contra.refractory.hypertension">HTA refractaria (&gt;180/110)</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fca5a5;" onclick="toggleCheck('gestacion')">
                        <input type="checkbox" id="gestacion" onclick="event.stopPropagation()">
                        <span style="font-size: 13px;" data-i18n="contra.pregnancy">Gestaci√≥n</span>
                    </div>

                    <div class="checkbox-item" style="border-color: #fca5a5;" onclick="toggleCheck('ictusAit')">
                        <input type="checkbox" id="ictusAit" onclick="event.stopPropagation()">
                        <span style="font-size: 13px;" data-i18n="contra.previous.stroke">Ictus/AIT previo</span>
                    </div>
                </div>

                <!-- Estrategia -->
                <div class="section section-strategy" style="margin-top: 20px;">
                    <h2 data-i18n="section.strategy">üíâ Estrategia de Reperfusi√≥n</h2>
                    
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label data-i18n="strategy.decision">Decisi√≥n</label>
                        <select id="decision" onchange="updateStrategy()">
                            <option value="" data-i18n-value="strategy.select">Seleccionar...</option>
                            <option value="icp" data-i18n-value="strategy.primary.pci">Angioplastia primaria (ICP)</option>
                            <option value="fibrinolisis" data-i18n-value="strategy.fibrinolysis">Fibrin√≥lisis in situ</option>
                        </select>
                    </div>

                    <div id="motivoFibrinolisis" style="display: none; margin-bottom: 20px;">
                        <label data-i18n="strategy.fibrinolysis.reason">Motivo de fibrin√≥lisis</label>
                        <textarea id="motivoFibrinolisisText" data-i18n-placeholder="strategy.fibrinolysis.reason.placeholder" placeholder="Ej: Tiempo traslado estimado >90 min"></textarea>
                    </div>

                    <div class="form-group" style="margin-bottom: 20px;">
                        <label data-i18n="strategy.hospital.label">Hospital de destino</label>
                        <input type="text" id="hospitalDestino" data-i18n-placeholder="strategy.hospital.placeholder" placeholder="Nombre del hospital">
                    </div>

                    <!-- Recomendaci√≥n segundo antiagregante -->
                    <div class="info-box yellow">
                        <div style="font-weight: 700; font-size: 15px; margin-bottom: 8px; color: #854d0e;" data-i18n="strategy.antiplatelet.title">
                            Segundo antiagregante recomendado:
                        </div>
                        <button class="btn-warning" onclick="calculateAntiplatelet()" data-i18n="strategy.antiplatelet.calculate">
                            Calcular recomendaci√≥n
                        </button>
                        <div id="antiplateletResult" style="margin-top: 12px; padding: 12px; background: white; border-radius: 6px; font-weight: 700; font-size: 16px; color: #1e293b; text-transform: uppercase; text-align: center; display: none;">
                        </div>
                    </div>

                    <!-- Calculadora TNK -->
                    <div id="tnkCalculator" style="display: none;" class="info-box red">
                        <div style="font-weight: 700; font-size: 15px; margin-bottom: 8px; color: #991b1b;" data-i18n="strategy.tnk.title">
                            Dosis Tenecteplasa calculada:
                        </div>
                        <div class="dose-display" id="tnkDose"></div>
                        <div style="font-size: 14px; color: #991b1b;" id="tnkVolume"></div>
                    </div>
                </div>

                <!-- Medicaci√≥n -->
                <div class="section section-meds" style="margin-top: 20px;">
                    <h2 data-i18n="section.medication">üíä Medicaci√≥n Administrada</h2>
                    
                    <div id="medicationList"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <button class="btn-warning" onclick="copyReport()" style="background: #f59e0b; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3); padding: 16px 32px; font-size: 16px; border-radius: 12px; display: inline-flex; align-items: center; gap: 10px;" data-i18n="btn.copy.report">
                üìã Copiar Informe al Portapapeles
            </button>
        </div>
    </div>

    <script>
        // Datos de medicamentos con dosis sugeridas e instrucciones
        const medications = [
            { 
                id: 'aspirina', 
                name: 'AAS (Aspirina)', 
                doseOptions: ['300 mg'],
                defaultRoute: 'VO',
                instructions: '‚úì Masticar y tragar para mejor absorci√≥n\n‚úì Dosis de carga en IAM\n‚úì Administrar lo antes posible'
            },
            { 
                id: 'clopidogrel', 
                name: 'Clopidogrel', 
                doseOptions: ['300 mg', '600 mg'],
                defaultRoute: 'VO',
                instructions: '‚úì Dosis de carga: 600 mg (preferida)\n‚úì 300 mg si edad >75 a√±os\n‚úì Tragar entero con agua'
            },
            { 
                id: 'ticagrelor', 
                name: 'Ticagrelor', 
                doseOptions: ['180 mg'],
                defaultRoute: 'VO',
                instructions: '‚úì Dosis de carga: 2 comprimidos de 90 mg\n‚úì NO requiere ajuste por edad\n‚úì Tragar entero con agua'
            },
            { 
                id: 'prasugrel', 
                name: 'Prasugrel', 
                doseOptions: ['60 mg'],
                defaultRoute: 'VO',
                instructions: '‚úì Dosis de carga: 60 mg (6 comprimidos de 10 mg)\n‚ö†Ô∏è Contraindicado si: edad >75 a√±os, peso <60 kg, AIT/ictus previo\n‚úì Tragar entero con agua'
            },
            { 
                id: 'tenecteplasa', 
                name: 'Tenecteplasa (TNK)', 
                doseOptions: ['Seg√∫n peso (ver calculadora)'],
                defaultRoute: 'IV',
                instructions: '‚úì Bolo √∫nico IV en 5-10 segundos\n‚úì Usar calculadora autom√°tica arriba\n‚úì Reconstituir con 10 ml de agua est√©ril\n‚ö†Ô∏è Verificar ausencia de contraindicaciones'
            },
            { 
                id: 'enoxaparina', 
                name: 'Enoxaparina', 
                doseOptions: ['30 mg IV + 1 mg/kg SC', '1 mg/kg SC c/12h', '0.75 mg/kg SC c/12h (>75a o I.Renal)'],
                defaultRoute: 'IV + SC',
                instructions: '< 75 a√±os SIN insuficiencia renal (Cr <2.5 mg/dl o <2 mg/dl en mujeres):\n‚úì Bolo 30 mg IV\n‚úì Seguido a los 15 min: 1 mg/kg SC (m√°x 100 mg 1¬™ dosis)\n\n‚â• 75 a√±os Y/O insuficiencia renal:\n‚úì NO bolo IV inicial\n‚úì 0.75 mg/kg SC c/12h (m√°x 75 mg)\n\n‚úì SC en abdomen, alternar lados\n‚ö†Ô∏è Ajustar si FG <30 ml/min: considerar HNF'
            },
            { 
                id: 'morfina', 
                name: 'Morfina', 
                doseOptions: ['2-3 mg IV', '3-5 mg IV', '5-10 mg IV'],
                defaultRoute: 'IV',
                instructions: '‚úì Diluir 10 mg en 9 ml de suero (1 ml = 1 mg)\n‚úì Administrar lentamente en 2-3 min\n‚úì Puede repetir cada 5-10 min si precisa\n‚ö†Ô∏è NO administrar si TAS <90 mmHg\n‚ö†Ô∏è Vigilar depresi√≥n respiratoria'
            },
            { 
                id: 'nitroglicerina', 
                name: 'Nitroglicerina', 
                doseOptions: ['0.4 mg SL', '0.4 mg SL (repetir x3)', '5-10 mcg/min IV'],
                defaultRoute: 'SL / IV',
                instructions: '‚úì Sublingual: 0.4 mg (1 comp), puede repetir cada 5 min (m√°x 3 dosis)\n‚úì IV: Iniciar 5-10 mcg/min, titular seg√∫n TA\n‚ö†Ô∏è CONTRAINDICADO: TAS <90, IAM VD, sildenafil √∫ltimas 24h\n‚úì Paciente sentado o semisentado'
            }
        ];

        // Renderizar lista de medicamentos
        function renderMedicationList() {
            const container = document.getElementById('medicationList');
            container.innerHTML = medications.map(med => {
                const doseOptionsHTML = med.doseOptions.map(opt => 
                    `<option value="${opt}">${opt}</option>`
                ).join('');
                
                return `
                <div class="med-item not-given" id="med-${med.id}">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="check-${med.id}" 
                               onchange="toggleMedication('${med.id}')"
                               style="width: 20px; height: 20px; cursor: pointer;">
                        <span style="font-weight: 700; font-size: 15px;">${med.name}</span>
                    </label>
                    <div id="inputs-${med.id}" style="display: none;">
                        <div class="med-inputs" style="margin-top: 8px;">
                            <select id="dose-${med.id}" style="grid-column: 1 / 3;">
                                ${doseOptionsHTML}
                            </select>
                            <input type="time" id="time-${med.id}">
                        </div>
                        <div id="instructions-${med.id}" style="background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%); padding: 14px; border-radius: 8px; margin-top: 10px; border-left: 4px solid #3b82f6; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-weight: 700; color: #075985; font-size: 13px; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                                <span style="font-size: 16px;">üíâ</span>
                                <span>V√≠a: ${med.defaultRoute}</span>
                            </div>
                            <div style="color: #0c4a6e; font-size: 12px; white-space: pre-line; line-height: 1.6; background: white; padding: 10px; border-radius: 6px;">
                                ${med.instructions}
                            </div>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function toggleMedication(medId) {
            const checkbox = document.getElementById(`check-${medId}`);
            const medItem = document.getElementById(`med-${medId}`);
            const inputs = document.getElementById(`inputs-${medId}`);
            const timeInput = document.getElementById(`time-${medId}`);
            
            if (checkbox.checked) {
                medItem.classList.remove('not-given');
                medItem.classList.add('given');
                inputs.style.display = 'block';
                if (!timeInput.value) {
                    timeInput.value = new Date().toTimeString().slice(0, 5);
                }
                
                // Alertas contextuales espec√≠ficas
                showMedicationAlerts(medId);
            } else {
                medItem.classList.remove('given');
                medItem.classList.add('not-given');
                inputs.style.display = 'none';
            }
            
            // Actualizar recomendaciones si es aspirina o nitroglicerina
            if (medId === 'aspirina' || medId === 'nitroglicerina') {
                updateRecomendaciones();
            }
        }
        
        function showMedicationAlerts(medId) {
            const tas = parseFloat(document.getElementById('tas').value);
            const infartoVD = document.getElementById('infartoVD').checked;
            const edad = parseInt(document.getElementById('edad').value);
            const peso = parseFloat(document.getElementById('peso').value);
            const ictusAit = document.getElementById('ictusAit').checked;
            
            // Aspirina - medicamento prioritario
            if (medId === 'aspirina') {
                alert('‚úì ASPIRINA - Medicamento PRIORITARIO\n\n‚Ä¢ Administrar lo ANTES posible\n‚Ä¢ MASTICAR y tragar (mejor absorci√≥n)\n‚Ä¢ Beneficio probado en reducir mortalidad\n\n‚è±Ô∏è Objetivo: <10 min desde primer contacto');
            }
            
            // Morfina con hipotensi√≥n
            if (medId === 'morfina' && tas && tas < 90) {
                alert('‚ö†Ô∏è PRECAUCI√ìN: TAS <90 mmHg\n\nLa morfina est√° CONTRAINDICADA en hipotensi√≥n.\nPuede empeorar el shock.\n\nValorar riesgo/beneficio cuidadosamente.');
            }
            
            // Nitroglicerina con hipotensi√≥n
            if (medId === 'nitroglicerina' && tas && tas < 90) {
                alert('üö´ CONTRAINDICACI√ìN ABSOLUTA\n\nNitroglicerina con TAS <90 mmHg puede causar:\n‚Ä¢ Colapso cardiovascular\n‚Ä¢ Empeoramiento del shock\n\nNO ADMINISTRAR');
                document.getElementById(`check-${medId}`).checked = false;
                toggleMedication(medId);
                return;
            }
            
            // Nitroglicerina con infarto VD
            if (medId === 'nitroglicerina' && infartoVD) {
                if (tas && tas < 100) {
                    alert('üö´ CONTRAINDICACI√ìN ABSOLUTA\n\nInfarto VD + TAS <100 mmHg:\nLa nitroglicerina puede causar hipotensi√≥n severa y colapso.\n\nNO ADMINISTRAR');
                    document.getElementById(`check-${medId}`).checked = false;
                    toggleMedication(medId);
                    return;
                } else {
                    alert('‚ö†Ô∏è EXTREMA PRECAUCI√ìN\n\nInfarto de ventr√≠culo derecho detectado.\n\nLa nitroglicerina puede causar hipotensi√≥n severa.\n\nSolo administrar si TAS >100 mmHg y con monitorizaci√≥n continua.');
                }
            }
            
            // Prasugrel con contraindicaciones
            if (medId === 'prasugrel') {
                let warnings = [];
                if (edad > 75) warnings.push('‚Ä¢ Edad >75 a√±os');
                if (peso < 60) warnings.push('‚Ä¢ Peso <60 kg');
                if (ictusAit) warnings.push('‚Ä¢ Antecedente de AIT/ictus');
                
                if (warnings.length > 0) {
                    alert('üö´ CONTRAINDICACI√ìN para Prasugrel:\n\n' + warnings.join('\n') + '\n\nUsar TICAGRELOR en su lugar.');
                    document.getElementById(`check-${medId}`).checked = false;
                    toggleMedication(medId);
                    return;
                }
            }
            
            // Clopidogrel - sugerencia de dosis seg√∫n edad
            if (medId === 'clopidogrel' && edad > 75) {
                const doseSelect = document.getElementById('dose-clopidogrel');
                doseSelect.value = '300 mg';
                alert('üí° SUGERENCIA\n\nEdad >75 a√±os: Se ha seleccionado autom√°ticamente dosis de 300 mg (en lugar de 600 mg) por seguridad.\n\nPuedes cambiarla si lo consideras necesario.');
            }
            
            // Enoxaparina - sugerencia seg√∫n edad
            if (medId === 'enoxaparina' && edad >= 75) {
                const doseSelect = document.getElementById('dose-enoxaparina');
                doseSelect.value = '0.75 mg/kg SC c/12h (>75a o I.Renal)';
                alert('üí° AJUSTE POR EDAD\n\nEdad ‚â•75 a√±os:\n‚Ä¢ Dosis: 0.75 mg/kg SC c/12h (m√°x 75 mg)\n‚Ä¢ SIN bolo IV de 30 mg\n\n‚ö†Ô∏è Tambi√©n usar esta dosis si hay insuficiencia renal\n(Creatinina >2.5 mg/dl o >2 mg/dl en mujeres)');
            }
            
            // TNK - recordar usar calculadora
            if (medId === 'tenecteplasa') {
                const peso = parseFloat(document.getElementById('peso').value);
                const edad = parseInt(document.getElementById('edad').value);
                
                if (!peso) {
                    alert('üí° RECORDATORIO\n\nPara calcular la dosis de TNK:\n\n1. Ingresa el PESO del paciente arriba\n2. Selecciona "Fibrin√≥lisis" en Estrategia de Reperfusi√≥n\n3. La dosis se calcular√° autom√°ticamente\n\n‚ö†Ô∏è Verifica TODAS las contraindicaciones antes de administrar.');
                } else {
                    // Calcular dosis
                    const mayor75 = edad > 75;
                    let dose;
                    if (peso < 60) dose = mayor75 ? 15 : 30;
                    else if (peso <= 70) dose = mayor75 ? 17.5 : 35;
                    else if (peso <= 80) dose = mayor75 ? 20 : 40;
                    else if (peso <= 90) dose = mayor75 ? 22.5 : 45;
                    else dose = mayor75 ? 25 : 50;
                    
                    const volume = (dose / 5).toFixed(1);
                    alert(`‚úì DOSIS CALCULADA\n\nPeso: ${peso} kg\nEdad: ${edad > 75 ? '>75 a√±os (dosis reducida)' : '‚â§75 a√±os'}\n\nDOSIS TNK: ${dose} mg\nVOLUMEN: ${volume} ml\n\nüìã Preparaci√≥n:\n‚Ä¢ Reconstituir con 10 ml de agua est√©ril\n‚Ä¢ Administrar en bolo IV (5-10 seg)\n‚Ä¢ Verificar contraindicaciones`);
                }
            }
        }

        // Actualizar reloj
        function updateClock() {
            const now = new Date();
            document.getElementById('currentTime').textContent = 
                now.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            document.getElementById('currentDate').textContent = 
                now.toLocaleDateString('es-ES', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        }

        function markTime(fieldId) {
            const now = new Date();
            document.getElementById(fieldId).value = now.toTimeString().slice(0, 5);
        }

        function toggleCheck(checkId) {
            const checkbox = document.getElementById(checkId);
            checkbox.checked = !checkbox.checked;
            checkActivation();
        }

        function checkActivation() {
            const hasSTEMI = document.getElementById('elevacionST').checked ||
                            document.getElementById('patronWinter').checked ||
                            document.getElementById('depresionSTconAVR').checked ||
                            document.getElementById('infartoPosterior').checked ||
                            document.getElementById('infartoVD').checked ||
                            document.getElementById('bbefh').checked ||
                            document.getElementById('bbdfh').checked ||
                            document.getElementById('marcapassos').checked;
            
            // Detectar shock autom√°ticamente por TAS o Killip IV
            const tas = parseFloat(document.getElementById('tas').value);
            const killip = document.getElementById('killip').value;
            const hasShockCardiogenico = (tas && tas < 90) || killip === '4';
            
            // Mostrar/ocultar alerta de shock
            const alertaShock = document.getElementById('alertaShock');
            if (hasShockCardiogenico) {
                alertaShock.style.display = 'block';
                if (killip === '4') {
                    alertaShock.querySelector('div:last-child').textContent = 'Killip IV = Shock cardiog√©nico. Activaci√≥n URGENTE.';
                } else {
                    alertaShock.querySelector('div:last-child').textContent = 'TAS <90 mmHg sugiere shock. Valorar cl√≠nica completa.';
                }
            } else {
                alertaShock.style.display = 'none';
            }
            
            // Detectar HTA refractaria autom√°ticamente
            const tad = parseFloat(document.getElementById('tad').value);
            const htaRefractariaCheckbox = document.getElementById('htaRefractaria');
            if (tas && tad && tas > 180 && tad > 110) {
                htaRefractariaCheckbox.checked = true;
            } else if (tas && tad && (tas <= 180 || tad <= 110)) {
                // Solo desmarcar si AMBOS valores est√°n por debajo del umbral
                htaRefractariaCheckbox.checked = false;
            }
            
            const hasVeryHighRisk = hasShockCardiogenico ||
                                   document.getElementById('dolorRefractario').checked;
            
            const clinicaTipica = document.getElementById('clinicaSi') && document.getElementById('clinicaSi').checked;
            const clinicaAtipica = document.getElementById('clinicaNo') && document.getElementById('clinicaNo').checked;
            const ecgControl = document.getElementById('ecgControl').value;
            const alertBox = document.getElementById('alertaActivacion');
            const alertTexto = document.getElementById('alertaTexto');
            const alertTitulo = alertBox.querySelector('.text');
            
            // DECISI√ìN DE ACTIVACI√ìN
            let shouldActivate = false;
            let alertType = '';
            
            // CASO 1: MUY ALTO RIESGO - Activar SIEMPRE inmediatamente
            if (hasVeryHighRisk) {
                shouldActivate = true;
                alertType = 'inmediato';
                alertTitulo.textContent = '¬°ACTIVAR C√ìDIGO IAM INMEDIATAMENTE!';
                alertTexto.textContent = 'Paciente de MUY ALTO RIESGO (shock/dolor refractario). Activaci√≥n URGENTE - llamar 061/112 AHORA.';
            }
            // CASO 2: CL√çNICA T√çPICA + ECG compatible - Activar inmediatamente
            else if (hasSTEMI && clinicaTipica) {
                shouldActivate = true;
                alertType = 'inmediato';
                alertTitulo.textContent = '¬°ACTIVAR C√ìDIGO IAM AHORA!';
                alertTexto.textContent = 'Cl√≠nica T√çPICA + ECG compatible. NO esperar ECG control. Llamar 061/112 inmediatamente.';
            }
            // CASO 3: ECG control confirma elevaci√≥n persistente
            else if (hasSTEMI && ecgControl) {
                shouldActivate = true;
                alertType = 'inmediato';
                alertTitulo.textContent = '¬°ACTIVAR C√ìDIGO IAM AHORA!';
                alertTexto.textContent = 'Elevaci√≥n del ST CONFIRMADA como persistente en ECG de control. Llamar 061/112 inmediatamente.';
            }
            // CASO 4: CL√çNICA AT√çPICA o SIN DEFINIR + ECG compatible - Sugerir ECG control
            else if (hasSTEMI && (clinicaAtipica || (!clinicaTipica && !clinicaAtipica))) {
                shouldActivate = true;
                alertType = 'control';
                alertTitulo.textContent = '‚ö†Ô∏è Elevaci√≥n del ST con cl√≠nica at√≠pica/dudosa';
                
                // NO sugerir NTG si hay infarto de VD
                const infartoVD = document.getElementById('infartoVD').checked;
                if (infartoVD) {
                    alertTexto.textContent = '‚ö†Ô∏è INFARTO VD: NO administrar NTG (riesgo de hipotensi√≥n). ECG de control a los 15 min para valorar persistencia. Si persiste ‚Üí Activar.';
                } else {
                    alertTexto.textContent = 'Considerar: 1) NTG sublingual, 2) ECG de control a los 15 min para descartar espasmo coronario (Prinzmetal). Si persiste ‚Üí Activar.';
                }
            }
            // CASO 5: ECG positivo pero sin valorar cl√≠nica a√∫n
            else if (hasSTEMI && !clinicaTipica && !clinicaAtipica) {
                shouldActivate = true;
                alertType = 'evaluar';
                alertTitulo.textContent = 'üìä ECG con elevaci√≥n del ST detectada';
                alertTexto.textContent = 'Valorar CL√çNICA arriba: Si t√≠pica ‚Üí ACTIVAR YA. Si at√≠pica/dudosa ‚Üí considerar ECG de control.';
            }
            
            // Aplicar estilos seg√∫n tipo de alerta
            if (shouldActivate) {
                alertBox.style.display = 'flex';
                if (alertType === 'inmediato') {
                    alertBox.style.background = '#dc2626';
                    alertBox.style.borderColor = '#7f1d1d';
                    alertTexto.style.color = 'white';
                    alertTitulo.style.color = 'white';
                } else if (alertType === 'control') {
                    alertBox.style.background = '#fef3c7';
                    alertBox.style.borderColor = '#fde047';
                    alertTexto.style.color = '#854d0e';
                    alertTitulo.style.color = '#854d0e';
                } else {
                    alertBox.style.background = '#dbeafe';
                    alertBox.style.borderColor = '#93c5fd';
                    alertTexto.style.color = '#1e40af';
                    alertTitulo.style.color = '#1e40af';
                }
            } else {
                alertBox.style.display = 'none';
            }
            
            // Actualizar recomendaciones
            updateRecomendaciones();
        }
        
        function updateRecomendaciones() {
            const recomendaciones = [];
            const recordatorios = [];
            
            // === RECOMENDACIONES BASADAS EN DATOS CL√çNICOS ===
            
            // Valoraci√≥n de cl√≠nica pendiente con ECG positivo
            const hasSTEMI = document.getElementById('elevacionST').checked ||
                            document.getElementById('patronWinter').checked ||
                            document.getElementById('depresionSTconAVR').checked;
            const clinicaTipica = document.getElementById('clinicaSi') && document.getElementById('clinicaSi').checked;
            const clinicaAtipica = document.getElementById('clinicaNo') && document.getElementById('clinicaNo').checked;
            
            if (hasSTEMI && !clinicaTipica && !clinicaAtipica) {
                recomendaciones.push({
                    tipo: 'advertencia',
                    icon: 'üë®‚Äç‚öïÔ∏è',
                    texto: 'Valorar CL√çNICA del paciente',
                    detalle: 'ECG positivo detectado. CR√çTICO: Valorar si la cl√≠nica es T√çPICA (activar ya) o AT√çPICA (considerar ECG control). Ver secci√≥n "Datos Cl√≠nicos" arriba.'
                });
            }
            
            // SpO2
            const spo2 = parseFloat(document.getElementById('spo2').value);
            if (spo2 && spo2 < 90) {
                recomendaciones.push({
                    tipo: 'critico',
                    icon: 'ü´Å',
                    texto: 'SpO‚ÇÇ <90%: Administrar oxigenoterapia',
                    detalle: 'Objetivo: mantener SpO‚ÇÇ ‚â•94%. Usar c√°nula nasal o mascarilla seg√∫n necesidad.'
                });
            } else if (spo2 && spo2 >= 90 && spo2 < 94) {
                recomendaciones.push({
                    tipo: 'advertencia',
                    icon: 'ü´Å',
                    texto: 'SpO‚ÇÇ 90-94%: Considerar oxigenoterapia',
                    detalle: 'Monitorizar estrechamente. Ox√≠geno si tendencia descendente.'
                });
            }
            
            // Shock cardiog√©nico (detectado autom√°ticamente por TAS o Killip IV)
            const tas = parseFloat(document.getElementById('tas').value);
            const killip = document.getElementById('killip').value;
            const shockDetectado = (tas && tas < 90) || killip === '4';
            
            if (shockDetectado) {
                let causaShock = '';
                if (killip === '4') causaShock = 'Killip IV';
                else if (tas < 90) causaShock = 'TAS <90 mmHg';
                
                recomendaciones.push({
                    tipo: 'critico',
                    icon: 'üíâ',
                    texto: `¬°SHOCK CARDIOG√âNICO! (${causaShock})`,
                    detalle: '‚Ä¢ V√≠a venosa de gran calibre (14-16G)\n‚Ä¢ Considerar segunda v√≠a\n‚Ä¢ Monitorizaci√≥n hemodin√°mica continua\n‚Ä¢ Avisar a UCI/Hemodin√°mica URGENTE\n‚Ä¢ NO administrar betabloqueantes ni nitratos'
                });
                
                recomendaciones.push({
                    tipo: 'info',
                    icon: 'üíä',
                    texto: 'Considerar soporte inotr√≥pico',
                    detalle: 'Valorar dopamina o dobutamina seg√∫n protocolo. Traslado prioritario.'
                });
            }
            
            // Presi√≥n arterial - Solo hipotensi√≥n (HTA se maneja m√°s abajo con tad)
            if (tas && tas < 90) {
                recomendaciones.push({
                    tipo: 'critico',
                    icon: '‚ö†Ô∏è',
                    texto: 'Hipotensi√≥n severa (TAS <90 mmHg)',
                    detalle: 'CONTRAINDICACI√ìN para nitratos y morfina. Asegurar v√≠a venosa. Considerar expansi√≥n con cristaloides (250-500ml).'
                });
            }
            
            // Infarto de VD + nitratos
            if (document.getElementById('infartoVD').checked) {
                if (tas && tas < 100) {
                    recomendaciones.push({
                        tipo: 'critico',
                        icon: '‚ùå',
                        texto: 'Infarto VD con TAS <100: CONTRAINDICADO nitratos',
                        detalle: '¬°PELIGRO! NO administrar nitroglicerina. Riesgo de hipotensi√≥n severa y colapso cardiovascular. Expansi√≥n con volumen si hipotensi√≥n.'
                    });
                } else {
                    recomendaciones.push({
                        tipo: 'advertencia',
                        icon: '‚ö†Ô∏è',
                        texto: 'Infarto VD: EXTREMA PRECAUCI√ìN con nitratos',
                        detalle: 'Los nitratos pueden causar hipotensi√≥n severa en IAM de VD. Evitar completamente si TAS <100 mmHg. Usar con extrema precauci√≥n si TAS ‚â•100.'
                    });
                }
                
                recomendaciones.push({
                    tipo: 'info',
                    icon: 'üíß',
                    texto: 'Infarto VD: Expansi√≥n de volumen si hipotensi√≥n',
                    detalle: 'Si hipotensi√≥n: cristaloides 250-500ml en bolo. Repetir seg√∫n respuesta. NO usar diur√©ticos.'
                });
            }
            
            // Frecuencia card√≠aca
            const fc = parseFloat(document.getElementById('fc').value);
            if (fc && fc < 50) {
                recomendaciones.push({
                    tipo: 'advertencia',
                    icon: 'üíì',
                    texto: 'Bradicardia (FC <50 lpm)',
                    detalle: 'Monitorizar estrechamente. Tener atropina disponible. Si compromiso hemodin√°mico: atropina 0.5mg IV.'
                });
            } else if (fc && fc > 120) {
                recomendaciones.push({
                    tipo: 'advertencia',
                    icon: 'üíì',
                    texto: 'Taquicardia (FC >120 lpm)',
                    detalle: 'Descartar arritmias en monitor. Si taquicardia sinusal: puede indicar dolor, ansiedad o compromiso hemodin√°mico.'
                });
            }
            
            // Killip
            if (killip === '3') {
                recomendaciones.push({
                    tipo: 'critico',
                    icon: 'ü´Å',
                    texto: 'Killip III: Edema agudo de pulm√≥n',
                    detalle: 'Posici√≥n semisentada, ox√≠geno, furosemida 40-80mg IV, nitratos IV (si TAS >100), morfina. Traslado urgente.'
                });
            } else if (killip === '4') {
                recomendaciones.push({
                    tipo: 'critico',
                    icon: 'üö®',
                    texto: 'Killip IV: Shock cardiog√©nico',
                    detalle: 'M√°xima prioridad. Ver recomendaciones de shock cardiog√©nico arriba.'
                });
            }
            
            // HTA refractaria (detectada autom√°ticamente)
            const tad = parseFloat(document.getElementById('tad').value);
            if (tas && tad && tas > 180 && tad > 110) {
                recomendaciones.push({
                    tipo: 'critico',
                    icon: '‚ö†Ô∏è',
                    texto: 'HTA REFRACTARIA (>180/110) - CONTRAINDICACI√ìN para fibrin√≥lisis',
                    detalle: 'Contraindicaci√≥n ABSOLUTA para fibrin√≥lisis. Intentar control tensional urgente con nitratos IV. Si no se controla ‚Üí ICP aunque tiempo >120 min.'
                });
            } else if (tas && tas > 180) {
                recomendaciones.push({
                    tipo: 'advertencia',
                    icon: '‚ö†Ô∏è',
                    texto: 'HTA severa (TAS >180 mmHg)',
                    detalle: 'Puede contraindicar fibrin√≥lisis si TAD >110. Considerar nitratos para control tensional. Valorar ICP.'
                });
            }
            
            // Anticoagulaci√≥n oral + Fibrin√≥lisis
            const decision = document.getElementById('decision').value;
            const anticoagulacion = document.getElementById('anticoagulacion').checked;
            if (anticoagulacion && decision === 'fibrinolisis') {
                recomendaciones.push({
                    tipo: 'critico',
                    icon: '‚ö†Ô∏è',
                    texto: '¬°ALTO RIESGO! Anticoagulaci√≥n + Fibrin√≥lisis',
                    detalle: 'Paciente en anticoagulaci√≥n oral activa. ALTO riesgo hemorr√°gico con fibrin√≥lisis. Considerar fuertemente ICP en su lugar. Si fibrin√≥lisis es √∫nica opci√≥n: monitorizaci√≥n muy estrecha.'
                });
            }
            
            // Gestaci√≥n
            if (document.getElementById('gestacion').checked) {
                recomendaciones.push({
                    tipo: 'critico',
                    icon: 'ü§∞',
                    texto: 'GESTACI√ìN - Contraindicaci√≥n ABSOLUTA para fibrin√≥lisis',
                    detalle: 'ICP es la estrategia preferida independientemente del tiempo. Coordinar con obstetricia. NO administrar fibrinol√≠ticos.'
                });
            }
            
            // Detecci√≥n de contraindicaciones para fibrin√≥lisis
            const contraFibrinolisis = document.getElementById('hemorragiaCerebral').checked ||
                                      document.getElementById('avcReciente').checked ||
                                      document.getElementById('traumaCirugia').checked ||
                                      document.getElementById('sangradoActivo').checked ||
                                      document.getElementById('htaRefractaria').checked ||
                                      document.getElementById('gestacion').checked;
            
            if (contraFibrinolisis && decision === 'fibrinolisis') {
                recomendaciones.push({
                    tipo: 'critico',
                    icon: 'üö´',
                    texto: '¬°CONTRAINDICACI√ìN ABSOLUTA PARA FIBRIN√ìLISIS!',
                    detalle: 'Has seleccionado fibrin√≥lisis pero existen contraindicaciones absolutas. CAMBIAR a ICP urgente (traslado prioritario aunque >120 min).'
                });
            }
            
            // Dolor refractario
            if (document.getElementById('dolorRefractario').checked) {
                recomendaciones.push({
                    tipo: 'advertencia',
                    icon: 'üíä',
                    texto: 'Dolor refractario al tratamiento',
                    detalle: 'Considerar: Morfina 3-5mg IV (si TAS >90), nitroglicerina IV (si TAS >100). Indica isquemia persistente - reperfusi√≥n URGENTE.'
                });
            }
            
            // Patr√≥n de De Winter
            if (document.getElementById('patronWinter').checked) {
                recomendaciones.push({
                    tipo: 'critico',
                    icon: 'üìä',
                    texto: 'Patr√≥n De Winter detectado',
                    detalle: 'EQUIVALENTE A STEMI. Indica oclusi√≥n proximal de LAD. Activaci√≥n INMEDIATA aunque no haya elevaci√≥n ST t√≠pica.'
                });
            }
            
            // === RECORDATORIOS BASADOS EN TIEMPO ===
            
            const ahora = new Date();
            const primerContacto = document.getElementById('primerContacto').value;
            const ecgRealizado = document.getElementById('ecgRealizado').value;
            const ecgControl = document.getElementById('ecgControl').value;
            const activacionCodigo = document.getElementById('activacionCodigo').value;
            const aspirinaAdmin = document.getElementById('check-aspirina').checked;
            const ntgAdmin = document.getElementById('check-nitroglicerina').checked;
            
            // Convertir tiempos
            if (primerContacto) {
                const [h1, m1] = primerContacto.split(':').map(Number);
                const tiempoPrimerContacto = new Date(ahora);
                tiempoPrimerContacto.setHours(h1, m1, 0, 0);
                const minutosDesde = Math.floor((ahora - tiempoPrimerContacto) / 60000);
                
                // ECG no realizado despu√©s de 10 min
                if (!ecgRealizado && minutosDesde > 10) {
                    recordatorios.push({
                        tipo: 'critico',
                        icon: 'üìä',
                        texto: `Han pasado ${minutosDesde} minutos sin ECG inicial`,
                        detalle: 'OBJETIVO: ECG en <10 minutos desde primer contacto. Realizar inmediatamente.'
                    });
                } else if (!ecgRealizado && minutosDesde > 5) {
                    recordatorios.push({
                        tipo: 'advertencia',
                        icon: 'üìä',
                        texto: `${minutosDesde} minutos desde primer contacto`,
                        detalle: 'Pendiente ECG de 12 derivaciones.'
                    });
                }
                
                // Aspirina no administrada
                if (!aspirinaAdmin && minutosDesde > 15) {
                    recordatorios.push({
                        tipo: 'advertencia',
                        icon: 'üíä',
                        texto: 'Aspirina no registrada',
                        detalle: 'Si no hay contraindicaciones: AAS 300mg VO (masticar).'
                    });
                }
            }
            
            // Recordatorio de ECG de control tras ECG inicial con hallazgos
            if (ecgRealizado && !ecgControl) {
                const hasSTEMIFindings = document.getElementById('elevacionST').checked ||
                                        document.getElementById('patronWinter').checked ||
                                        document.getElementById('depresionSTconAVR').checked;
                
                const clinicaTipica = document.getElementById('clinicaSi') && document.getElementById('clinicaSi').checked;
                const clinicaAtipica = document.getElementById('clinicaNo') && document.getElementById('clinicaNo').checked;
                
                if (hasSTEMIFindings) {
                    const [h2, m2] = ecgRealizado.split(':').map(Number);
                    const tiempoECG = new Date(ahora);
                    tiempoECG.setHours(h2, m2, 0, 0);
                    const minutosDesdeECG = Math.floor((ahora - tiempoECG) / 60000);
                    
                    // Si cl√≠nica T√çPICA, no sugerir ECG control, sugerir activaci√≥n directa
                    if (clinicaTipica && minutosDesdeECG > 2) {
                        recordatorios.push({
                            tipo: 'critico',
                            icon: 'üìû',
                            texto: `Cl√≠nica t√≠pica + ECG compatible - ${minutosDesdeECG} min sin activar`,
                            detalle: '¬°NO ESPERAR ECG de control! Con cl√≠nica t√≠pica + ECG compatible ‚Üí ACTIVAR C√ìDIGO IAM YA. Llamar 061/112.'
                        });
                    }
                    // Si cl√≠nica AT√çPICA o sin definir, sugerir ECG control
                    else if ((clinicaAtipica || (!clinicaTipica && !clinicaAtipica))) {
                        const infartoVD = document.getElementById('infartoVD').checked;
                        
                        if (!ntgAdmin && minutosDesdeECG > 2 && !infartoVD) {
                            // Solo sugerir NTG si NO hay infarto VD
                            recordatorios.push({
                                tipo: 'advertencia',
                                icon: 'üíä',
                                texto: 'Cl√≠nica at√≠pica - Pendiente nitroglicerina y ECG control',
                                detalle: 'Administrar NTG sublingual (si no contraindicado) y repetir ECG a los 15 minutos para descartar espasmo coronario.'
                            });
                        } else if (!ntgAdmin && minutosDesdeECG > 2 && infartoVD) {
                            // Si hay infarto VD, NO sugerir NTG
                            recordatorios.push({
                                tipo: 'advertencia',
                                icon: '‚ö†Ô∏è',
                                texto: 'Infarto VD - NO administrar NTG',
                                detalle: '‚ö†Ô∏è CONTRAINDICADO NTG en infarto VD (riesgo hipotensi√≥n). Realizar ECG de control a los 15 minutos sin NTG.'
                            });
                        } else if (ntgAdmin && minutosDesdeECG >= 15) {
                            recordatorios.push({
                                tipo: 'critico',
                                icon: 'üìä',
                                texto: `${minutosDesdeECG} min desde ECG inicial - Realizar ECG de control`,
                                detalle: 'ECG de control para confirmar si elevaci√≥n persiste (STEMI) o ha desaparecido (posible espasmo).'
                            });
                        } else if (ntgAdmin && minutosDesdeECG >= 12 && minutosDesdeECG < 15) {
                            recordatorios.push({
                                tipo: 'advertencia',
                                icon: 'üìä',
                                texto: 'Pr√≥ximo ECG de control (15 min post-NTG)',
                                detalle: 'Preparar ECG de control para verificar persistencia de elevaci√≥n del ST.'
                            });
                        }
                    }
                }
            }
            
            // C√≥digo no activado pero tiene ECG de control con criterios persistentes
            if (ecgControl && !activacionCodigo) {
                const hasSTEMI = document.getElementById('elevacionST').checked ||
                                document.getElementById('patronWinter').checked ||
                                document.getElementById('depresionSTconAVR').checked ||
                                document.getElementById('infartoPosterior').checked ||
                                document.getElementById('infartoVD').checked ||
                                document.getElementById('bbefh').checked ||
                                document.getElementById('bbdfh').checked ||
                                document.getElementById('marcapassos').checked;
                
                const tas = parseFloat(document.getElementById('tas').value);
                const killip = document.getElementById('killip').value;
                const hasVeryHighRisk = (tas && tas < 90) || killip === '4' ||
                                       document.getElementById('dolorRefractario').checked;
                
                if (hasSTEMI || hasVeryHighRisk) {
                    const [h3, m3] = ecgControl.split(':').map(Number);
                    const tiempoControl = new Date(ahora);
                    tiempoControl.setHours(h3, m3, 0, 0);
                    const minutosDesdeControl = Math.floor((ahora - tiempoControl) / 60000);
                    
                    if (minutosDesdeControl > 3) {
                        recordatorios.push({
                            tipo: 'critico',
                            icon: 'üìû',
                            texto: `ECG de control con elevaci√≥n PERSISTENTE - ${minutosDesdeControl} min sin activar`,
                            detalle: '¬°Elevaci√≥n del ST CONFIRMADA como persistente! Llamar al 061/112 AHORA para activaci√≥n del C√≥digo IAM.'
                        });
                    }
                }
            }
            
            // Objetivo ECG-Bal√≥n
            if (activacionCodigo) {
                const [h3, m3] = activacionCodigo.split(':').map(Number);
                const tiempoActivacion = new Date(ahora);
                tiempoActivacion.setHours(h3, m3, 0, 0);
                const minutosDesdeActivacion = Math.floor((ahora - tiempoActivacion) / 60000);
                
                if (minutosDesdeActivacion > 90) {
                    recordatorios.push({
                        tipo: 'advertencia',
                        icon: '‚è±Ô∏è',
                        texto: `${minutosDesdeActivacion} minutos desde activaci√≥n`,
                        detalle: 'Objetivo ECG-Bal√≥n: <120 min. Coordinar traslado urgente.'
                    });
                }
            }
            
            // Renderizar recomendaciones
            renderRecomendaciones(recomendaciones, recordatorios);
        }
        
        function renderRecomendaciones(recomendaciones, recordatorios) {
            const panelRec = document.getElementById('recomendacionesPanel');
            const listRec = document.getElementById('recomendacionesList');
            const panelRecordatorios = document.getElementById('recordatoriosPanel');
            const listRecordatorios = document.getElementById('recordatoriosList');
            
            // Recomendaciones cl√≠nicas
            if (recomendaciones.length > 0) {
                panelRec.style.display = 'block';
                listRec.innerHTML = recomendaciones.map(rec => {
                    const bgColor = rec.tipo === 'critico' ? '#fee2e2' : 
                                   rec.tipo === 'advertencia' ? '#fef3c7' : '#e0f2fe';
                    const borderColor = rec.tipo === 'critico' ? '#fca5a5' : 
                                       rec.tipo === 'advertencia' ? '#fde047' : '#93c5fd';
                    const textColor = rec.tipo === 'critico' ? '#991b1b' : 
                                     rec.tipo === 'advertencia' ? '#854d0e' : '#075985';
                    
                    return `
                        <div style="background: ${bgColor}; padding: 15px; border-radius: 8px; border-left: 4px solid ${borderColor};">
                            <div style="font-weight: 700; color: ${textColor}; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 20px;">${rec.icon}</span>
                                <span>${rec.texto}</span>
                            </div>
                            <div style="color: ${textColor}; font-size: 13px; white-space: pre-line; opacity: 0.9;">
                                ${rec.detalle}
                            </div>
                        </div>
                    `;
                }).join('');
            } else {
                panelRec.style.display = 'none';
            }
            
            // Recordatorios de tiempo
            if (recordatorios.length > 0) {
                panelRecordatorios.style.display = 'block';
                listRecordatorios.innerHTML = recordatorios.map(rec => {
                    const bgColor = rec.tipo === 'critico' ? '#fee2e2' : '#fef3c7';
                    const borderColor = rec.tipo === 'critico' ? '#fca5a5' : '#fde047';
                    const textColor = rec.tipo === 'critico' ? '#991b1b' : '#854d0e';
                    
                    return `
                        <div style="background: ${bgColor}; padding: 15px; border-radius: 8px; border-left: 4px solid ${borderColor};">
                            <div style="font-weight: 700; color: ${textColor}; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 20px;">${rec.icon}</span>
                                <span>${rec.texto}</span>
                            </div>
                            <div style="color: ${textColor}; font-size: 13px; white-space: pre-line; opacity: 0.9;">
                                ${rec.detalle}
                            </div>
                        </div>
                    `;
                }).join('');
            } else {
                panelRecordatorios.style.display = 'none';
            }
        }

        function updateContraindications() {
            const edad = parseInt(document.getElementById('edad').value);
            const peso = parseFloat(document.getElementById('peso').value);
            
            // Auto-marcar contraindicaciones seg√∫n edad/peso si aplica
            // (opcional, puedes implementar m√°s l√≥gica aqu√≠)
        }

        function updateStrategy() {
            const decision = document.getElementById('decision').value;
            document.getElementById('motivoFibrinolisis').style.display = 
                decision === 'fibrinolisis' ? 'block' : 'none';
            document.getElementById('tnkCalculator').style.display = 
                decision === 'fibrinolisis' ? 'block' : 'none';
            calculateTNK();
            updateRecomendaciones();
        }

        function calculateTNK() {
            const peso = parseFloat(document.getElementById('peso').value);
            const edad = parseInt(document.getElementById('edad').value);
            const decision = document.getElementById('decision').value;
            
            if (!peso || decision !== 'fibrinolisis') return;
            
            const mayor75 = edad > 75;
            let dose;
            
            if (peso < 60) dose = mayor75 ? 15 : 30;
            else if (peso <= 70) dose = mayor75 ? 17.5 : 35;
            else if (peso <= 80) dose = mayor75 ? 20 : 40;
            else if (peso <= 90) dose = mayor75 ? 22.5 : 45;
            else dose = mayor75 ? 25 : 50;
            
            const volume = (dose / 5).toFixed(1);
            
            document.getElementById('tnkDose').textContent = dose + ' mg';
            document.getElementById('tnkVolume').textContent = 
                'Volumen: ' + volume + ' ml' + (mayor75 ? ' (dosis reducida >75 a√±os)' : '');
        }

        function calculateAntiplatelet() {
            const altoRiesgo = document.getElementById('hemorragiaCerebral').checked ||
                              document.getElementById('sangradoActivo').checked ||
                              document.getElementById('anticoagulacion').checked;
            
            const edad = parseInt(document.getElementById('edad').value);
            const peso = parseFloat(document.getElementById('peso').value);
            
            const contraPrasugrel = document.getElementById('ictusAit').checked ||
                                   edad > 75 ||
                                   peso < 60;
            
            let recommendation;
            if (altoRiesgo) {
                recommendation = 'CLOPIDOGREL (Alto riesgo hemorr√°gico)';
            } else if (contraPrasugrel) {
                recommendation = 'TICAGRELOR (Sin contraindicaciones)';
            } else {
                recommendation = 'TICAGRELOR o PRASUGREL';
            }
            
            const resultDiv = document.getElementById('antiplateletResult');
            resultDiv.textContent = recommendation;
            resultDiv.style.display = 'block';
        }

        function generateReport() {
            const edad = document.getElementById('edad').value || i18n.t('report.not.specified.fem');
            const sexo = document.getElementById('sexo').value === 'M' ? i18n.t('patient.gender.male') : i18n.t('patient.gender.female');
            const peso = document.getElementById('peso').value || i18n.t('report.not.specified');
            const alergias = document.getElementById('alergias').value || i18n.t('report.not.known');
            
            // Hallazgos ECG
            let hallazgosECG = '';
            if (document.getElementById('elevacionST').checked) hallazgosECG += '‚úì ' + i18n.t('ecg.st.elevation') + '\n';
            if (document.getElementById('patronWinter').checked) hallazgosECG += '‚úì ' + i18n.t('ecg.winter.pattern') + '\n';
            if (document.getElementById('depresionSTconAVR').checked) hallazgosECG += '‚úì ' + i18n.t('ecg.st.depression.avr') + '\n';
            if (document.getElementById('infartoPosterior').checked) hallazgosECG += '‚úì ' + i18n.t('ecg.posterior.infarction') + '\n';
            if (document.getElementById('infartoVD').checked) hallazgosECG += '‚úì ' + i18n.t('ecg.right.ventricle') + '\n';
            if (document.getElementById('bbefh').checked) hallazgosECG += '‚úì ' + i18n.t('ecg.new.lbbb') + '\n';
            if (document.getElementById('bbdfh').checked) hallazgosECG += '‚úì ' + i18n.t('ecg.new.rbbb') + '\n';
            if (document.getElementById('marcapassos').checked) hallazgosECG += '‚úì ' + i18n.t('ecg.pacemaker') + '\n';
            if (document.getElementById('otrosECG').value) hallazgosECG += i18n.t('report.other.findings') + ': ' + document.getElementById('otrosECG').value + '\n';

            if (hallazgosECG === '') hallazgosECG = i18n.t('report.no.findings') + '\n';
            
            // Datos cl√≠nicos adicionales
            let datosAdicionales = '';
            const tas = parseFloat(document.getElementById('tas').value);
            const killip = document.getElementById('killip').value;
            if ((tas && tas < 90) || killip === '4') {
                let causa = killip === '4' ? 'Killip IV' : i18n.t('clinical.sbp') + ' <90 mmHg';
                datosAdicionales += `‚ö†Ô∏è ${i18n.t('report.cardiogenic.shock')} (${causa})\n`;
            }
            if (document.getElementById('dolorRefractario').checked) datosAdicionales += '‚ö†Ô∏è ' + i18n.t('report.refractory.pain') + '\n';
            
            let report = '';
            report += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
            report += '                    ' + i18n.t('report.title') + '\n';
            report += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n';

            report += i18n.t('report.patient.data') + '\n';
            report += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n';
            report += i18n.t('report.age') + ': ' + edad + ' ' + i18n.t('report.years') + '\n';
            report += i18n.t('report.sex') + ': ' + sexo + '\n';
            report += i18n.t('report.weight') + ': ' + peso + ' ' + i18n.t('report.kg') + '\n';
            report += i18n.t('report.allergies') + ': ' + alergias + '\n';
            
            // Valoraci√≥n de cl√≠nica
            const clinicaTipica = document.getElementById('clinicaSi') && document.getElementById('clinicaSi').checked;
            const clinicaAtipica = document.getElementById('clinicaNo') && document.getElementById('clinicaNo').checked;
            if (clinicaTipica) {
                report += i18n.t('report.clinical.typical') + '\n';
            } else if (clinicaAtipica) {
                report += i18n.t('report.clinical.atypical') + '\n';
            }
            report += '\n';
            
            report += i18n.t('report.timeline') + '\n';
            report += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n';
            report += i18n.t('timeline.symptom.onset') + ': ' + (document.getElementById('inicioSintomas').value || i18n.t('report.not.registered')) + '\n';
            report += i18n.t('timeline.first.contact') + ': ' + (document.getElementById('primerContacto').value || i18n.t('report.not.registered')) + '\n';
            report += i18n.t('timeline.ecg.initial') + ': ' + (document.getElementById('ecgRealizado').value || i18n.t('report.not.registered')) + '\n';
            report += i18n.t('timeline.ecg.control') + ': ' + (document.getElementById('ecgControl').value || i18n.t('report.not.registered')) + '\n';
            report += i18n.t('timeline.activation') + ': ' + (document.getElementById('activacionCodigo').value || i18n.t('report.not.registered')) + '\n\n';
            
            report += i18n.t('report.ecg.findings') + '\n';
            report += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n';
            report += hallazgosECG + '\n';

            report += i18n.t('report.clinical.data') + '\n';
            report += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n';
            report += i18n.t('clinical.bp') + ': ' + (document.getElementById('tas').value || '---') + '/' + (document.getElementById('tad').value || '---') + ' mmHg\n';
            report += i18n.t('clinical.hr') + ': ' + (document.getElementById('fc').value || '---') + ' lpm\n';
            report += i18n.t('clinical.o2sat') + ': ' + (document.getElementById('spo2').value || '---') + '%\n';
            report += i18n.t('report.killip.class') + ': ' + document.getElementById('killip').value + '\n';
            if (datosAdicionales) report += datosAdicionales;
            report += '\n';
            
            report += i18n.t('report.strategy') + '\n';
            report += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n';
            const decisionValue = document.getElementById('decision').value;
            report += i18n.t('report.decision') + ': ';
            if (decisionValue === 'icp') {
                report += i18n.t('report.primary.angioplasty') + '\n';
            } else if (decisionValue === 'fibrinolisis') {
                report += i18n.t('report.fibrinolysis.in.situ') + '\n';
            } else {
                report += i18n.t('report.not.decided') + '\n';
            }
            report += i18n.t('report.destination.hospital') + ': ' + (document.getElementById('hospitalDestino').value || i18n.t('report.not.specified')) + '\n\n';
            
            report += i18n.t('report.medication.administered') + '\n';
            report += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n';

            medications.forEach(med => {
                const checked = document.getElementById('check-' + med.id).checked;
                if (checked) {
                    const dose = document.getElementById('dose-' + med.id).value;
                    const time = document.getElementById('time-' + med.id).value;
                    report += '‚úì ' + med.name + ': ' + dose + ' ' + med.defaultRoute + ' - ' + time + '\n';
                }
            });

            report += '\n';
            report += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
            const locale = i18n.currentLang === 'ca' ? 'ca-ES' : i18n.currentLang === 'es' ? 'es-ES' : i18n.currentLang === 'fr' ? 'fr-FR' : 'en-US';
            report += i18n.t('report.generated') + ': ' + new Date().toLocaleString(locale) + '\n';
            report += 'M√©dico responsable: ____________________________________\n';
            report += 'Firma: ____________________________________\n';
            report += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê';

            return report;
        }

        function copyReport() {
            try {
                const report = generateReport();

                // Intentar usar la API moderna del portapapeles
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(report).then(function() {
                        alert(i18n.t('report.copy.success'));
                    }).catch(function(err) {
                        // Si falla, usar m√©todo alternativo
                        fallbackCopy(report);
                    });
                } else {
                    // M√©todo alternativo para navegadores antiguos
                    fallbackCopy(report);
                }
            } catch (error) {
                alert(i18n.t('report.copy.error') + ': ' + error.message);
                console.error(error);
            }
        }
        
        function fallbackCopy(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();

            try {
                document.execCommand('copy');
                alert(i18n.t('report.copy.success'));
            } catch (err) {
                alert(i18n.t('report.copy.fallback'));
            }

            document.body.removeChild(textarea);
        }

        // Inicializaci√≥n
        updateClock();
        setInterval(updateClock, 1000);
        renderMedicationList();
        
        // Actualizar recomendaciones cada 30 segundos (para recordatorios de tiempo)
        setInterval(updateRecomendaciones, 30000);
        
        // Actualizar recomendaciones cuando cambien datos cl√≠nicos
        document.getElementById('spo2').addEventListener('input', updateRecomendaciones);
        document.getElementById('tas').addEventListener('input', function() {
            checkActivation(); // Detectar shock autom√°ticamente
            updateRecomendaciones();
        });
        document.getElementById('tad').addEventListener('input', updateRecomendaciones);
        document.getElementById('fc').addEventListener('input', updateRecomendaciones);
        document.getElementById('killip').addEventListener('change', function() {
            checkActivation(); // Detectar Killip IV como shock
            updateRecomendaciones();
        });
        document.getElementById('decision').addEventListener('change', updateRecomendaciones);
        document.getElementById('anticoagulacion').addEventListener('change', updateRecomendaciones);
        document.getElementById('gestacion').addEventListener('change', updateRecomendaciones);
        
        // Listeners para contraindicaciones
        ['hemorragiaCerebral', 'avcReciente', 'traumaCirugia', 'sangradoActivo', 'htaRefractaria', 'ictusAit'].forEach(id => {
            document.getElementById(id).addEventListener('change', updateRecomendaciones);
        });
        
        // Listeners para edad y peso (afectan antiagregantes y TNK)
        document.getElementById('edad').addEventListener('input', function() {
            calculateTNK();
            updateRecomendaciones();
        });
        document.getElementById('peso').addEventListener('input', function() {
            calculateTNK();
            updateRecomendaciones();
        });
        document.getElementById('primerContacto').addEventListener('change', updateRecomendaciones);
        document.getElementById('ecgRealizado').addEventListener('change', updateRecomendaciones);
        document.getElementById('ecgControl').addEventListener('change', updateRecomendaciones);
        document.getElementById('activacionCodigo').addEventListener('change', updateRecomendaciones);
        document.getElementById('check-aspirina').addEventListener('change', updateRecomendaciones);
        document.getElementById('check-nitroglicerina').addEventListener('change', updateRecomendaciones);

        // Manejo de errores global
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            console.error('Error: ' + msg + '\nURL: ' + url + '\nLine: ' + lineNo + '\nColumn: ' + columnNo + '\nError object: ' + JSON.stringify(error));
            return false;
        };

        // Funciones del modal de ayuda
        function toggleHelp() {
            const modal = document.getElementById('helpModal');
            modal.style.display = modal.style.display === 'none' ? 'block' : 'none';
            if (modal.style.display === 'block') {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = 'auto';
            }
        }

        function showHelpTab(tabName) {
            // Ocultar todos los contenidos
            document.querySelectorAll('.help-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Desactivar todos los tabs
            document.querySelectorAll('.help-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostrar el contenido seleccionado
            document.getElementById('tab-' + tabName).style.display = 'block';
            
            // Activar el tab seleccionado
            document.querySelector(`.help-tab[data-tab="${tabName}"]`).classList.add('active');
        }

        // Cerrar modal con ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modal = document.getElementById('helpModal');
                if (modal.style.display === 'block') {
                    toggleHelp();
                }
            }
        });
    </script>

    <!-- Translations Script -->
    <script src="translations.js"></script>
</body>
</html>
